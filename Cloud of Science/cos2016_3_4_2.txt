О некоторых свойствах сопряженных круговых дуг 



1. Введение 

В системах автоматизированного проектирования для описания контуров сложной формы широко применяются так называемые кусочно-непрерывные методы аппроксимации, суть которых состоит в том, что криволинейный контур представляется в виде последовательности сопряженных между собой дуг каких-либо кривых (например, парабол второго, третьего или более высокого порядка). В зависимости от решаемой задачи на проектируемый контур накладываются определенные условия гладкости. В простейшем случае это условие непрерывности изменения угла наклона касательной при переходе через точку сопряжения, более жесткие требования включают непрерывность изменения кривизны кривой. На эту тему имеется множество публикаций, в качестве примера можно привести статьи [1–4], в которых приведены многочисленные ссылки на работы, освещающие различные стороны проблемы.  

Выбор круговых дуг в качестве аппроксимирующих кривых обусловлен тем, что в устройствах машинной графики (графопостроителях, плоттерах) а также в применяемых в машиностроении металлообрабатывающих станках с ЧПУ для перемещения рабочего органа используется два типа интерполяторов: линейный и круговой. Описание контура с помощью таких графических примитивов, как отрезки прямых и круговые дуги позволяет получить управляющую программу для станка с ЧПУ без дополнительных преобразований, в результате чего уменьшаются погрешности при воспроизведении контура. Обзор публикаций на эту тему позволяет сделать вывод о том, что авторы в основном уделяют внимание методам минимизации погрешности при аппроксимации, а также проблемам устойчивости. При этом на второй план отходят вопросы, связанные с практическим построением пары сопряженных дуг, поскольку эта задача представляется достаточно простой. Тем не менее необходимость исследований в этом направлении очевидна. Свидетельством этому может служить статья [5], в которой автор описывает достаточно сложную процедуру сопряжения при аппроксимации круговыми дугами швейных лекал. Возможно, что подобная проблема возникает и при решении других практических задач. 

В работе описан метод построения пары сопряженных круговых дуг, соединяющих две точки на плоскости с заданными в них направлениями касательных векторов. Он достаточно прост с вычислительной точки зрения, более того, он может быть применен для вычерчивания сопряженных дуг «вручную», с использованием только циркуля и линейки.  

2. Вспомогательная окружность и ее свойства 

Пусть на концах отрезка АВ заданы направления векторами и 

 Первый под углом  (отсчитывается против часовой стрелке), второй — под углом  (по часовой стрелке). Требуется построить пару сопряженных дуг, первая из которых выходит из А в направлении а вторая приходит в В по направлению (рис. 1а). 

Рисунок 1. Построение пары сопряженных круговых дуг: 

а — пример построения; б — вспомогательная окружность с центром в точке пересечения срединного перпендикуляра к отрезку AB и линии биссектрисы угла  

Точки и лежат на линиях возможных центров, определяемых векторами и ортогональных векторам и соответственно. Через точку пересечения этих линий проведем линию, являющуюся биссектрисой угла  (см. рис. 1б). 

Точку пересечения этой линии со срединным перпендикуляром к отрезку АВ обозначим S. Из этой точки, как из центра, проведем окружность, проходящую через концы отрезка. 

Нетрудно показать, что и что радиус этой окружности равен 

Данная окружность обладает весьма интересными свойствами. В работе [6] она была названа вспомогательной, поскольку с ее помощью выполняются все необходимые построения. Покажем, что любая точка Q вспомогательной окружности является точкой сопряжения двух круговых дуг, первая из которых выходит из точки A в направлении а вторая приходит в точку B в направлении 

Возьмем произвольную точку Q на вспомогательной окружности и соединим ее с концами отрезка АВ (рис. 2). 

Рисунок 2. Нахождение центров и по заданной точке Q на вспомогательной окружности 

Проведем срединные перпендикуляры к отрезкам AQ и QB до пересечения с линиями возможных центров. Точки пересечения обозначим и Нетрудно видеть, что это искомые центры первой и второй дуги. Действительно, и по построению. Кроме того, из равенства углов и следует, что центры дуг и Q лежат на одной прямой, а значит, в точке сопряжения дуги имеют общую касательную. Таким образом, выбор точки на вспомогательной окружности однозначно определяет пару сопряженных в этой точке круговых дуг. 

3. Свойства семейства кривых, представленных парой сопряженных дуг 

Выше был рассмотрен частный случай положения точки Q на вспомогательной окружности. Однако нетрудно убедиться в том, что любой другой выбор Q приводит к тем же результатам. 

Из сказанного следует, что на плоскости можно построить бесконечно много пар сопряженных между собой круговых дуг, соединяющих две точки, в которых заданы направления касательных векторов. Они образуют однопараметрическое семейство гладких кривых. В качестве параметра, характеризующего положение точки сопряжения, можно взять длину дуги вспомогательной окружности AQ или величину центрального угла 

 В этом случае радиусы сопряженных в точке Q дуг вычисляются по формулам 

Из этих формул следует, что при  = 2  радиус второй дуги  становится бесконечно большим. При этом точка сопряжения лежит на пересечении линии второй касательной со вспомогательной окружностью. Обозначим эту точку 

Вторая дуга при этом становится отрезком прямой 

 В этом случае точка сопряжения лежит на пересечении линии первой касательной со вспомогательной окружностью. Обозначим эту точку 

 Первая дуга так же, как и в предыдущем случае, вырождается в линию с нулевой кривизной и центр ее перемещается в бесконечно удаленную точку. Эти две возможные ситуации показаны на рис. 3. 

В системе координат, начало которой совпадает с точкой A, а ось Ox направлена вдоль отрезка AB, координаты центров дуг вычисляются по формулам 

Рисунок 3. Примеры построения дуг для случаев: а)  = 2; б)  = 2 –  + 

На рис. 4 показано семейство гладких кривых, представляющих собой пары сопряженных круговых дуг, соединяющих две точки с заданными в них направлениями касательных. Дуги окрашены в разные цвета. 

Рисунок 4. Множество пар сопряженных дуг, построенных с шагом  = 10о; углы наклона касательных: 

Обращает на себя внимание тот факт, что все дуги, выходящие из первой точки, лежат вне круга, границей которого является множество точек сопряжения, а все дуги, приходящие во вторую точку лежат внутри круга. 

Численные эксперименты показывают, что с уменьшением шага изменения параметра  количество кривых  растет и они начинают заполнять собой всю плоскость. Можно предположить, что через любую точку на плоскости можно провести пару сопряженных дуг, удовлетворяющих поставленным условиям. 

4. Построение кривой, проходящей через заданную точку 

Пусть на плоскости заданы направления касательных и в точках A и B соответственно. Требуется построить пару сопряженных дуг, первая из которых выходит из A по направлению а вторая приходит в B по направлению, при этом дополнительным условием является требование прохождения кривой через произвольную точку P. 
Рассмотрим две случая, связанных с положением точки P относительно круга, граница которого является вспомогательной окружностью, т. е. множеством возможных центров сопряжения дуг. 

1. Точка находится вне круга. 

В этом случае, как это следует из результатов, полученных в предыдущем разделе, через точку P проходит первая дуга, выходящая из точки A (см. рис. 4). Построим отрезок AP и проведем к нему срединный перпендикуляр до пересечения с линией возможных центров первой дуги. Обозначим ее  Окружность с радиусом и центром пересекает вспомогательную окружность в некоторой точке Q. Из результатов п. 2 следует, что точка Q однозначно определяет центр и радиус второй дуги. 

2. Точка находится внутри круга. 

В этом случае через точку P проходит вторая дуга, приходящая в точку B. Построим отрезок BP и проведем к нему срединный перпендикуляр до пересечения с линией возможных центров второй дуги. Обозначим ее 

 Окружность с радиусом и центром пересекает вспомогательную окружность в некоторой точке Q. Из результатов п. 2 следует, что точка Q однозначно определяет центр и радиус первой дуги. 

Примеры построений приведены на рис. 5. 

Рисунок 5. Примеры построения кривых, проходящих через заданную точку: 

а) точка P лежит вне круга, ограниченного вспомогательной окружностью; 

б) точка P лежит внутри круга 

5. Построение сопряженных дуг с минимальным скачком кривизны 

Кривая, составленная из пары сопряженных круговых дуг, является гладкой, поскольку обеспечивается непрерывность первой производной, т. е. изменения угла наклона касательной при переходе через точку сопряжения. Однако вторая производная изменяется  скачкообразно, поскольку имеет место скачок кривизны, равный  

Подставляя сюда выражения для и из (2), получим 

Минимум этой величины для различных значений  и   получается при 

Чтобы убедиться в том, что функция имеет локальный минимум в точке представим  в виде где  — малый параметр. 

Подставляя это выражение в (5) и раскладывая в ряд по степеням  до второго порядка малости включительно, получим [7]: 

Если обратиться к рис. 1б, где изображена вспомогательная окружность, то точка Q, соответствующая значению параметра находится на пересечении окружности и продолжением пунктирной линии (срединного перпендикуляра к отрезку AB). Это следует из того, что 

Рисунок 6. Построение сопряженных дуг с минимальным скачком кривизны: углы наклона касательных  = 60 ,  = 30; S — центр вспомогательной окружности, SQ — биссектриса угла ASB 

Таким образом, можно предложить следующий простой алгоритм построения пары сопряженных круговых дуг с минимальным скачком кривизны в точке сопряжения. 

1. По заданным на концах отрезка AB углам наклона касательных  и  проводятся линии возможных центров до их пересечения и методом, описанным в п. 1, строится вспомогательная окружность с центром в точке S. 

3. Определяется точка сопряжения Q как точка пересечения срединного перпендикуляра к отрезку AB со вспомогательной окружностью. Линия SQ при этом является биссектрисой угла ASB. 

4. К отрезкам AQ и QB проводятся срединные перпендикуляры (на рис. 6 показаны пунктиром) до их пересечения с линиями возможных центров первой и второй дуг соответственно. Точки пересечения и являются искомыми центрами дуг 

