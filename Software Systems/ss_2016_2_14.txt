Обогащение модели Bag-of-words семантическими связями для повышения качества классификации текстов предметной области



Модель Bag-of-words («набор слов») – самая популярная и простая модель представления текста, применяемая во многих задачах Text Mining . Модель представляет текст как набор слов без учета их взаимного расположения и взаимных связей. При ее использовании семантическая близость двух текстов (двух наборов слов) оценивается по количеству совпадающих слов. Это означает, что два текста, в которых мало общих слов или вообще нет, считаются семантически и тематически неблизкими. Игнорирование семантических связей между словами – главный недостаток модели Bag-of-words. Другой ее важный недостаток в том, что тексты как наборы слов проецируются в пространство высокой размерности и высокой разреженности, что обусловлено объемом используемого словаря. Как результат, возникает феномен «проклятия размерности», характеризующийся экспоненциальным ростом сложности вычислений из-за увеличения размерности данных. По этой причине модель Bag-of-words часто комбинируется с техниками редукции признакового пространства [3].

На преодоление недостатков модели Bag-of-words в последние годы направлено множество исследований. Большинство из них фокусируются на способах перехода от традиционного представления текстов в разреженном и зашумленном пространстве Bag-of-words к представлению в новых, семантически более богатых пространствах, в которых алгоритмы машинного обучения достигали бы лучших результатов . Это означает, что так или иначе, но все эти исследования манипулируют наборами семантически связанных слов, разница только в подходах к выбору и формированию этих наборов.

Среди существующих подходов можно выделить три основных класса работ. Первый класс работ объединяет подходы, формирующие наборы семантически связанных слов на основе концептов, второй – на основе контекстных векторов, третий – на основе латентных семантических связей.

Подход, используемый в данной работе, можно отнести ко второму классу. Авторы придерживаются точно такой же стратегии обогащения представлений текста семантическими связями, как в модели контекстных векторов: то есть строится матрица семантических связей, которая используется как оператор, отображающий тексты из пространства Bag-of-words в пространство контекстных векторов. Вклад данной работы заключается в новом способе построения и использования матрицы семантических связей. Предлагается трехэтапная процедура извлечения самых устойчивых и значимых связей, которые ее формируют.

Конечной целью работы является доказательство превосходства построенной модели по сравнению с моделью Bag-of-words при выполнении бинарной классификации текстов. Для сравнения этих двух моделей была реализована серия экспериментов на стандартной коллекции Reuters 21578. Результаты экспериментов демонстрируют улучшение качества классификации текстов по сравнению с известными методами.

Состояние проблемы и текущие исследования 

Подходы на основе модели концептов. В числе популярных расширений модели Bag-of-words, позволяющих учитывать семантические связи, модель Bag-of-concepts и ее вариации . Модель описывает представления текстов с помощью концептов, которые трактуются как категории, объединяющие семантически связанные слова. В работе  отмечается, что концепты как дескрипторы обладают тремя важнейшими преимуществами по сравнению со словами.

Во-первых, концепты менее избыточны, чем слова. Они позволяют «сворачивать» синонимы, так что, например, Российская Федерация и Россия понимаются как один термин.

Во-вторых, концепты обладают большей дискриминационной силой, чем слова. Они позволяют определять смысл многозначных слов по их окружению, так что, например, Apple в сочетании с Mac понимается как бренд, а не как фрукт.

В-третьих, концепты более эффективны, чем слова, при оценке близости текстов. Они позволяют выявить близость между двумя текстами, даже если те не содержат ни одного общего слова, как, например, тексты «Пеле – выдающийся бомбардир» и «Эдсон Арантис ду Насименту – лучший форвард» (рис. 1).

В приведенном примере под концептами понимаются синонимические ряды, объединяющие слова с одинаковыми или близкими значениями, что характерно для ранних работ в этой области . В более поздних работах под концептами понимаются уже не только ряды синонимов, но и другие категории связанных слов, например, семантические или тематические кластеры.

Важнейшей задачей, которая возникает при использовании модели Bag-of-concepts, является выбор концептов, соответствующих (близких) данному тексту . Обычно концепты и тексты индексируются с помощью слов, то есть каждому концепту сопоставляется вектор, где n – объем используемого словаря; веса слов в концепте, определяющие их важность для данного концепта. Аналогично каждому тексту сопоставляется вектор), где это веса тех же слов в этом тексте. Близость между концептом и текстом оценивается при помощи какого-либо критерия, оперирующего значениями этих векторов. В результате определяется набор из k самых близких тексту концептов, который и образует представление текста в новом пространстве. В работе  предлагаются две формулы для оценки близости между концептами и текстами. Первая формула предназначена для оценки контекстной близости на основе косинусной меры: 

Вторая формула предназначена для оценки ранговой близости на основе коэффициента корреляции Спирмена, определяющего, насколько совпадает порядок слов в концепте и в тексте: где T – это количество слов, входящих одновременно и в текст, и в концепт; rank – функция, возвращающая ранг (позицию) заданного слова в заданном тексте или в концепте.

Покажем, для чего нужна ранговая близость, на примере концепта «Женский футбол». Для указанного концепта высший приоритет имеют слова «женский» и «футбол». Если сравнивать два текста «Женский футбол – это захватывающее зрелище» и «Когда мужчины смотрят футбол, женские чары теряют силу», то очевидно, что, хотя оба текста содержат слова «женский» и «футбол», они имеют разное отношение к рассматриваемому концепту. Первый текст полностью коррелирует с этим концептом, а второй вообще не связан с ним. Здесь, помимо контекстной близости, важен относительный порядок слов в тексте. Поэтому в статье  предлагается использовать комбинированную оценку близости на основе контекстной и ранговой близости.

Подходы на основе модели контекстных векторов. Еще одним расширением модели Bag-of-words, позволяющим учитывать связи между словами, является модель контекстных векторов . Как следует из названия, модель формирует так называемые контекстные векторы слов, показывающие зависимость каждого слова от всех других слов используемого пространства. В этом состоит принципиальное отличие модели контекстных векторов от модели концептов, которая учитывает не все, а только избранные зависимости (связи) между словами.

Выделяют два основных способа вычисления контекстных связей между словами: низкоуровневый (на основе дистрибутивного анализа) и высокоуровневый (на основе специальных таксономий) . При высокоуровневом способе для оценки контекстных связей используются расстояния между семантическими классами, соответствующими словам в онтологии или в тезаурусе . Например, очень часто для таких целей используется тезаурус WordNet .

Контекстные векторы n-мерного пространства, записанные вместе, образуют квадратную матрицу «термины-на-термины» размерности. Эту матрицу также часто называют матрицей попарных связей или матрицей зависимостей, поскольку каждый ее элемент – не что иное, как численное выражение семантической связи между i-м и j-м словами (терминами).

Матрица семантических связей играет ключевую роль в формировании семантически обогащенных представлений текстов в пространстве контекстных векторов . По сути она является оператором перехода из одного пространства дескрипторов в другое.

Действительно, пусть текст d в исходном n-мерном пространстве несвязанных терминов имеет представление – это веса терминов в рассматриваемом тексте. Матрица семантических связей (назовем ее R) позволяет отобразить это исходное представление текста d в новое представление new d , отражающее связи между словами и в то же время сохраняющее информацию исходного представления: .  

Формула  дает сжатую форму записи представления текста в пространстве контекстных векторов. Развернув формулу, получим, что такое представление текста – не что иное, как линейная комбинация контекстных векторов: .

Подходы на основе латентной семантической модели. Еще один класс подходов, преодолевающих ограничение модели Bag-of-words, направлен на создание представлений текстов c помощью латентных тематик. Формирование таких представлений осуществляется путем факторизации матрицы «документы-на-термины» . Наиболее популярным методом среди подходов данного класса является латентный семантический анализ (LSA), который в качестве факторизации использует сингулярное разложение . Сингулярное разложение позволяет заменить исходную матрицу размерности ортогональными матрицами размерностей соответственно и диагональной матрицей размерности. При такой замене большая часть малозначимой и случайной информации теряется, зато отчетливей проявляются скрытые тематические тренды. По сути эти скрытые тренды представляют те же самые тематические концепты, только извлеченные особым способом.

Тот же принцип извлечения скрытых тематик лежит в основе метода неотрицательной матричной факторизации (NMF) , но вместо сингулярного разложения он использует разложение матрицы в произведение двух неотрицательных матриц (рис. 3). В работе  оба указанных метода (LSA и NMF) сравниваются по их способности к улучшению качества классификации текстов и делается вывод о превосходстве метода LSA.

Предлагаемый подход к автоматической классификации текстов 

Основная идея предлагаемого подхода. В данной работе предлагается обогащать представления текстов семантическими связями, которые извлекаются из этих же текстов. Под извлечением семантических связей, как обычно, понимается задача распознавания отношений, имеющих место между двумя и более сущностями в тексте . Для извлечения семантических связей используется статистика совместной встречаемости слов. Идея, лежащая в основе этого подхода, лаконично выражена в следующей знаменитой фразе: «You shall know a word by the company it keeps» . Авторы опираются на эту идею, полагая, что чем чаще два слова встречаются «в одной компании» (в данном случае в текстах одной тематики), тем сильнее между ними семантическая связь.

Статистику совместной встречаемости слов предоставляет матрица «документы-на-термины», описывающая распределение слов (терминов) в текстах (документах обучающей коллекции). Как следует из названия матрицы, ее строками являются документы, столбцами – термины, а элементами – частоты употребления терминов в документах (рис. 4). Поскольку «такие частотные матрицы имеют склонность быть разреженными и зашумленными, особенно если обучающая коллекция относительно мала в размерах» , авторы считают целесообразным до использования этой матрицы применить к ней два основных преобразования: редукцию и сингулярное разложение.

Редукция матрицы «документы-на-термины». Первое преобразование матрицы «документы-на-термины» заключается в редукции размерности этой матрицы, то есть в отбрасывании части ее столбцов и строк. Редукция необходима для извлечения семантических связей, которые относятся к интересующей нас теме (предметной области). Первым делом отсекаем «лишние» столбцы матрицы, соответствующие терминам других тем. Для этой цели можно использовать различные дискриминационные критерии . В данном случае используется критерий Пирсона (Хи-квадрат), который оценивает распределение каждого термина в текстах рассматриваемой темы (позитивном множестве) и текстах других тем (негативном множестве):  где A, B – количество документов позитивного множества, содержащих и не содержащих данный термин соответственно; C, D – количество документов негативного множества, содержащих и не содержащих данный термин соответственно . Значение данного критерия тем выше, чем чаще термин встречается в документах позитивного множества и чем реже в документах негативного множества. Этот факт позволяет нам отобрать термины с самыми высокими значениями критерия, то есть ключевые слова рассматриваемой темы.

Затем отсекаем «лишние» строки матрицы, соответствующие документам негативного множества. В результате получаем редуцированную матрицу «документы-на-термины», строки которой соответствуют текстам рассматриваемой темы, а столбцы – ее ключевым словам (рис. 5).

Сингулярное разложение матрицы «документы-на-термины». Второе преобразование матрицы «документы-на-термины» состоит в ее сингулярном разложении. Сингулярное разложение – это способ представления произвольной числовой матрицы A размерности  в виде произведения трех матриц:

где U и V – ортогональные матрицы размерностей соответственно (столбцы этих матриц называют левыми и правыми сингулярными векторами); S – диагональная матрица размерности  (ее диагональные элементы называют сингулярными числами) (рис. 6).

Согласно теореме Эккарта–Янга, сингулярное разложение позволяет снизить шум и разреженность исходной матрицы, заменяя ее матрицей той же размерности, но меньшего ранга, в которой сохранена только самая значимая информация . Более формально эта теорема звучит следующим образом.

Теорема 1 (Эккарт–Янг). Пусть дана матрица A размерности, для которой известно сингулярное разложение и которую требуется аппроксимировать матрицей Ak с заданным рангом. Если в матрице S оставить k наибольших сингулярных значений, а остальные заменить нулями, то разложение даст наилучшее приближение исходной матрицы A ранга k в смысле нормы Фробениуса. Если при этом элементы матрицы S отсортированы по убыванию, то выражение  может быть записано в другой форме,  где Uk и Vk – это матрицы, полученные выделением первых 𝑘 столбцов из матриц U и V соответственно (рис. 7). Сингулярное разложение, представленное равенством , называется экономным, поскольку в случае, когда k намного меньше m и n, оно позволяет произвести существенное сжатие исходной информации.

Сжатие понимается в том смысле, что часть информации, передаваемой исходной матрицей, теряется, а сохраняется только самая важная (доминантная) информация. Потеря информации происходит за счет пренебрежения малыми сингулярными числами, поэтому, чем больше сингулярных чисел отброшено, то есть чем меньше k, тем значительнее эта потеря.

Построение матрицы семантических связей «термины-на-термины» и ее использование для обогащения представлений текстов. Редуцированную и очищенную от шума матрицу «документы-на-термины» будем использовать для построения матрицы семантических связей «термины-на-термины». Поскольку в матрице «документы-на-термины» каждый термин представляет собой вектор-столбец, семантическую связь между любыми двумя терминами можно трактовать как близость или расстояние между соответствующими этим терминам векторами, используя любые известные меры близости или расстояния .

В данной работе используем косинусную меру:

где , – вектор-столбцы матрицы «документы-на-термины», соответствующие i-му и j-му терминам соответственно (i, j пробегают весь список терминов);  значение близости, элемент матрицы семантических связей (рис. 8).

Определение косинуса в первом квадранте декартовых координат позволяет утверждать, что максимально возможное значение близости между терминами равно 1, а минимально возможное – 0. Поскольку нас интересуют только самые сильные и устойчивые связи, не будем принимать во внимание значения близости ниже некоторого порога. Иными словами, будем отсекать слабые связи, обнуляя элементы матрицы, значения которых меньше порогового значения.

Использование матрицы семантических связей «термины-на-термины» для формирования новых представлений текстов. Построенная матрица семантических связей  используется для отображения представлений текстов в пространство связанных слов. В работе  для выполнения такого отображения используется формула . Если говорить в целом, то применение этой формулы увеличивает в представлениях текстов веса тех слов, которые имеют сильные семантические связи с другими словами. Увеличение весов происходит даже для тех слов, которые первоначально имели нулевые веса, то есть отсутствовали в исходных представлениях текстов. На следующем примере покажем, что в некоторых случаях это может негативно повлиять на качество работы классификатора.

Пример. Пусть коллекция из трех текстов индексируется ключевыми словами sea, cargo и cruise. 

Известно, что текст 1 относится к теме «Морские грузоперевозки», а текст 2 не относится к этой теме. Про текст 3 ничего не известно, однако отсутствие в этом тексте слова cargo и присутствие слова cruise позволяют предположить, что он, как и текст 2, относится, скорее, к теме «Морские путешествия», чем к теме «Морские грузоперевозки». Математическая оценка близости между текстами (на основе косинусной меры) не вносит ясности, так как оказывается, что текст 3 одинаково близок и к тексту 1, и к тексту 2 Матрица семантических связей для темы «Морские грузоперевозки» имеет вид  .

Подстановка этой матрицы в формулу  позволяет получить новые представления текстов, обогащенные семантическими связями.

Очевидно, в представлении текста 3 появилось ранее отсутствовавшее там слово cargo. Причем вес слова cargo благодаря сильной связи со словом sea увеличился с 0 до 2. Как результат, близость между текстом 3 и текстом 1 тоже увеличилась и даже стала больше, чем близость между текстом 3 и текстом 1.

Таким образом, в результате использования формулы  мы получили в представлении текста 3 ненужное там слово cargo, обеспечившее ложное «смещение» текста 3 к теме «Морские грузоперевозки». Приведенный пример демонстрирует несостоятельность формулы  в случае бинарной классификации, когда тексты из разных тем имеют общие ключевые слова. В приведенном примере таким общим для двух тем словом являлось слово sea, которое привело к включению в новое представление текста слова cargo, невзирая на его нулевой вес в исходном представлении текста. В данной работе авторы предлагают модифицировать формулу  с учетом наличия нулевых весов в исходных представлениях текстов.

Пусть дано исходное представление текста в виде вектора , где – веса слов в этом тексте; n – размерность пространства слов. Пусть задана матрица семантических связей, где . Тогда веса слов ' в новом представлении текста будем определять по правилу. 

Эксперименты 

Исходные данные для классификации. Для проведения экспериментов по бинарной классификации текстов была использована стандартная коллекция Reuters-21578, состоящая из 21 578 документов, распределенных между 135 пересекающимися темами. Как и в работах , для классификации были использованы только 12 самых крупных тем коллекции. Для каждой выбранной темы сформировано по 100 корпусов, содержащих все документы этой темы (позитивное множество) и примерно столько же выбранных случайным образом документов из других тем (негативное множество). При формировании корпусов соблюдались предустановленная разбивка документов на обучающие и тестовые, а также баланс между их количеством. В таблице 2 приведены примеры корпусов для каждой из 12 выбранных тем.

Метод и способ оценки результатов классификации. Классификация проводилась с помощью свободно распространяемого пакета вычислений R. В качестве алгоритма классификации использовалась машина опорных векторов (Support Vector Machine – SVM). В качестве итоговой оценки результатов классификации по каждой из 12 выбранных тем использовалось среднее значение F-меры в серии из 100 экспериментов. F-мера – это очень популярная мера оценки качества классификации, представляющая собой среднее гармоническое между точностью (P) и полнотой (R) классификации: . 
Каждый участвующий в эксперименте корпус текстов сначала подвергался токенизации (делению на слова), затем очищался от стоп-слов. Стемминг и лемматизация не проводились. При формировании представлений документов использовались не все слова, а только ключевые, то есть те, для которых значение критерия Хи-квадрат превысило критическое значение 6,6 (рис. 9). Это критическое значение было определено по специальной таблице, исходя из числа степеней свободы (для данной задачи равное 1) и уровня значимости, равного 1 % . (Следует отметить, что попутно были проверены другие критические значения в диапазоне от 1 до 10, то есть авторы увеличивали или сокращали список ключевых слов, регулируя его длину с помощью фильтра по критическому значению. Серия промежуточных экспериментов показала, что для задачи бинарной классификации список ключевых слов, определяемый значением 6,6, является оптимальным, то есть применение этого значения стабильно обеспечивает лучший результат классификации по сравнению с другими критическими значениями как при использовании традиционной модели Bag-of-words, так и при использовании рассматриваемой модели.) 

Веса ключевых слов в представлениях документов вычислялись с помощью метрики, которая равна частоте слова в документе Tf, умноженной на обратную документную частоту Idf, то есть на величину, обратную частоте данного слова во всех документах рассматриваемой выборки.

Сформировав представления документов в пространстве несвязанных ключевых слов Bag-of-words, авторы выполнили классификацию этих документов и использовали полученные результаты в качестве опорных, ориентируясь на которые, можно было бы судить об изменении качества классификации при обогащении представлений документов с помощью матрицы семантических связей.

Результаты классификации. Сравнительные результаты классификации представлены в табличном виде (табл. 3) и в графическом (рис. 10).

Как следует из приведенных результатов, прироста качества классификации удалось добиться в 10 темах из 12. В теме acq (второй по величине в коллекции Reuters) прирост качества нулевой, а в теме oilseed – отрицательный. Однако даже с учетом этих двух негативных результатов средний прирост качества по всем темам является положительным и составляет 1,6 %. Следует отметить также положительные выбросы для тем interest и sugar.

В будущих исследованиях предстоит выяснить причины ухудшения качества классификации в теме oilseed, которое наблюдается на фоне благополучных результатов классификации в остальных темах. Еще большего внимания заслуживает исследование причин положительных выбросов, в которых могут лежать возможные пути дальнейшего совершенствования предлагаемых методов.

В заключение отметим, что в данной работе построена математическая модель автоматической классификации текстов на основе известного подхода Bag-of-words, улучшенного за счет вовлечения в процесс классификации информации о семантических связях между словами, выявляемыми на основе статистики совместной встречаемости слов. Для редуцирования размерности матриц, порождаемых в процессе решения данной задачи, применены редукция и сингулярное разложение. Тестирование предложенного метода, проведенное на подмножестве стандартного корпуса документов Reuters-21578, показало некоторое улучшение качества классификации по комбинированному критерию, объединяющему точность и полноту классификации. Результаты проведенного исследования демонстрируют, что традиционные статистические методы анализа текстов могут быть улучшены за счет других статистических методов. Вместе с тем наблюдаемые в ходе экспериментов как положительные, так и отрицательные выбросы полученных значений показателя качества классификации требуют дальнейших исследований.

