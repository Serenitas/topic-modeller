, 004.921, 004.932.72'1.
Важность развития технологий для  переоценить невозможно.
Задачи, которые ставятся перед БПЛА, обусловлены их многочисленными приложениями как в военной, так и в гражданской сферах (например, картографирование, геологоразведка, сельское хозяйство, связь, охрана границ, лесов, полицейское патрулирование, мониторинг опасных объектов и процессов, информационное сопровождение чрезвычайных ситуаций, наблюдение за линиями электропередач, газои нефтепроводами).
В настоящее время в мире производится широкий ряд БПЛА, от тяжелых до сверхмалых, и создание надежных систем навигации этих аппаратов является важным направлением разработок.
Однако существует много проблем, связанных с управлением и навигацией БПЛА.
В частности, стабильность полета большинства из них существенно зависит от качества сигналов спутниковой связи GPS/ГЛОНАСС.
Поэтому создание автономной системы позиционирования, которая позволила бы БПЛА меньше зависеть  от спутниковой навигации, является актуальной, перспективной и важной научной задачей.
В рамках работ по Госконтракту был разработан  НавигаторМ, предназначенный для моделирования полета БПЛА, его автоматического позиционирования и управления .
о госрегистрации программы для ЭВМ 2012618314, авторы: В.М.
Хачумов, И.П.
Тищенко, Д.Н.
Степанов, В.Ф.
Заднепровский, В.П.
Фраленко, Ю.Г.
Емельянова, А.А.
Талалаев, Н.С.
Абрамов).
Применялись как широко известные методы и алгоритмы машинного зрения, компьютерной графики и параллельных вычислений, так и разработанные в рамках НИР.
Используемый язык программирования C/C++.
В качестве платформы для разработки была использована программная  .
Хачумов, И.П.
Тищенко, А.Ан.
Талалаев, К.А.
Константинов, В.П.
Фраленко, Ю.Г.
Емельянова).
Система имеет модульную архитектуру [1], ориентирована на конвейерно-параллельную обработку потока входных данных и снабжена графическим интерфейсом [2] для более удобной работы.
Разработанный комплекс состоит из нескольких программных модулей, предназначенных для решения определенных задач [3] и в рамках НСКиД именуемых логическими схемами.
Каждый модуль принимает на вход некоторый набор данных, решает закрепленную за ним подзадачу и отправляет результаты другим модулям.
Данная статья посвящена подробностям реализации некоторых задействованных в комплексе алгоритмов, теоретическое описание которых было представлено в работе [4].
Кроме того, отражены результаты экспериментов по моделированию полета виртуального БПЛА с установленной на нем видеокамерой и по автоматическому определению его положения и ориентации.
Приведены методики, которые, как ожидается, помогут усовершенствовать и развить методы автоматического позиционирования, а также приблизиться к внедрению заложенных в нем алгоритмов и идей на реальных БПЛА.
Летательный аппарат оснащен фотоили видеокамерой, жестко закрепленной или подвижной.
Известны технические характеристики камеры на БПЛА, а в случае ее подвижности ориентация камеры относительно аппарата.
Имеется спутниковый снимок местности, над которой БПЛА совершает полеты.
Для снимка с  задана географическая привязка.
Известны и технические характеристики камеры на ИСЗ.
Для данного участка Земли может быть доступна карта высот псевдоизображение, где каждому пикселю сопоставлена высота над уровнем моря той точки, проекция которой попадает в этот пиксель.
Спутниковый снимок вместе с картой высот составляют трехмерную модель данного участка земной поверхности.
Если карта высот отсутствует, считается, что участок является плоским.
Применительно к задаче моделирования снимок с ИСЗ применялся для генерации снимков с камеры на виртуальном аппарате.
Во время полета камера на БПЛА порождает некоторый набор кадров.
Для каждого кадра необходимо определить положение и ориентацию БПЛА, соответствующие этому кадру, без использования дополнительных датчиков (в том числе без использования GPS/ГЛОНАСС и инерциальной навигационной системы).
Обработка данных может выполняться на борту БПЛА или на наземной станции.
Для решения задачи был использован следующий подход: так как на каждом снимке с БПЛА запечатлен некоторый участок земной поверхности, который наблюдается и на снимке с ИСЗ, можно попытаться найти параметры проективного преобразования, связывающего два изображения, и тем самым вычислить взаимную ориентацию камер на ИСЗ  и БПЛА.
А так как спутниковый снимок имеет географическую привязку, то при известных параметрах искомого преобразования вычисление положения и ориентации БПЛА становится тривиальной задачей.
Вычислению неизвестных параметров предшествует поиск некоторого набора пар общих  точек, которые наблюдаемы на обоих изображениях [4].
Преимущество библиотеки GDAL в том, что она позволяет осуществлять проективные преобразования изображений и при этом не надо загружать изображения целиком в оперативную память компьютера.
Генерации снимков с БПЛА предшествует этап порождения траектории полета.
Траектория создается таким образом, что она включает в себя все опорные точки.
Для опорных точек могут быть заданы и требуемые углы ориентации БПЛА при его прохождении через данную точку.
Все сгенерированные кадры объединяются в видеофайл.
Реальные размеры изображения 10 000 на 10 000 пикселей, пространственное разрешение 1 метр на пиксель.
На первом шаге на изображениях выделяются два множества так называемых особых точек, для этого использовалась реализация алгоритма SURF [8].
На втором шаге для каждой особой точки строится ее дескриптор  набор чисел, позволяющий отличить одну особую точку от другой.
Библиотека предназначена для решения задачи поиска ближайшего соседа в пространствах большой размерности с применением случайных kd-деревьев .
Главная проблема в том, что файл, соответствующий спутниковому снимку местности, над которой виртуальный БПЛА совершает полеты, имеет значительные размеры .
Даже с использованием кластерных вычислительных установок работа с такими большими файлами может оказаться затруднительной, а в случае, если все вычисления должны выполняться на борту БПЛА, вообще невозможной.
Рассмотрим каждый из этих пунктов.
Основное назначение утилиты gdal2tiles обеспечить возможность просмотра больших и сверхбольших цифровых снимков земной поверхности с помощью обычных Web-браузеров.
Пусть имеется изображение шириной в пикселей и высотой в пикселей.
На жестком диске компьютера создается директорий, название каждой из них число от 0 до 1.
Содержимое директории с номером 1 соответствует самому нижнему уровню пирамиды, то есть исходному изображению, которое представлено в виде множества своих фрагментов.
В директории под номером 2  находятся фрагменты, которые в совокупности представляют собой изображение, полученное из исходного путем его уменьшения в 2 раза по ширине и высоте.
В директории под номером 3  в 4 раза и т.д.
В директории под номером создается поддиректорий, имя каждой поддиректории число в диапазоне от 0 до 1, в каждой из них сохраняется изображений.
Название каждого изображения состоит из числа в диапазоне от 0 до 1, а также расширения файла.
Содержимое каждой поддиректории соответствует всем фрагментам, принадлежащим одному столбцу слоя под номером.
Каждый фрагмент имеет размеры 256 на 256 пикселей.
На рисунке 2 показан результат работы утилиты gdal2tiles для изображения размером 1 574 на 854 пикселя.
Для каждого фрагмента каждого слоя пирамиды изображений, построенной на предыдущем шаге, производятся поиск особых точек на нем, вычисление дескриптора каждой особой точки и сохранение результатов на жесткий диск компьютера .
Данный процесс может быть распараллелен, поскольку работа с каждым фрагментом осуществляется независимо, а система НСКиД является конвейерно-параллельной.
Соответствующая логическая схема описана в разделе 10.1 статьи [3].
Данные, связанные с особыми точками на некотором фрагменте, сохраняются в виде набора файлов, названия которых имеют общий префикс следующего вида: A_B_C, где A номер слоя пирамиды, B количество строк в разбиении слоя на фрагменты, C количество столбцов.
В работе [6] приведено теоретическое описание алгоритма, позволяющего на спутниковом снимке выделить некоторую область в виде круга, а для определения положения и ориентации БПЛА в момент времени использовать только те особые точки на снимке с ИСЗ, которые попадают в эту область .
Для этого используются информация о положении и ориентации БПЛА в момент времени 1, технические характеристики камер на ИСЗ и БПЛА и высота, с которой был выполнен спутниковый снимок, или же пространственное разрешение камеры на ИСЗ.
Вычислению радиуса исходной области предшествует выбор наиболее подходящего слоя пирамиды для решения задачи позиционирования .
Всего в пирамиде слоев, самый нижний соответствует исходному спутниковому снимку и имеет номер 1, самый верхний уменьшен по сравнению с исходным в 2 раз по ширине и высоте.
Точке соответствует некоторая точка, лежащая на поверхности Земли.
Необходимо вычислить, какие координаты имеет проекция точки на слое пирамиды под номером.
Далее применяем алгоритм вычисления радиуса того круга, который соответствует области поиска, пусть он равен.
Затем вычисляем номера фрагментов изобласть.
Требуется сопоставить все особые точки, найденные на снимке с БПЛА, с особыми точками на каждом фрагменте.
Для минимизации числа обращений к жесткому диску при загрузке данных об особых точках, сопоставленных каждому фрагменту спутникового снимка, был использован следующий подход.
Создается очередь, каждый ее элемент номер некоторого фрагмента.
Все фрагменты на всех слоях пирамиды пронумерованы так, что номер каждого фрагмента уникален.
Максимальный размер очереди ограничен и вычисляется заранее по формулам из алгоритма сужения области поиска и исходя из средней высоты полета БПЛА.
Сами же данные хранятся в ассоциативном массиве data, где ключом является номер фрагмента, а значением набор данных об особых точках на этом фрагменте.
Если есть, то идет обращение к искомому элементу массива data для поиска пар соответствующих особых точек  и его номер запоминается.
Затем в цикле идет работа с оставшимися  фрагментами.
Их номера помещаются в очередь, а данные об особых точках в массив data.
Если очередь переполнена, ее последний элемент и соответствующие данные из массива dataудаляются из памяти.
Практически все алгоритмы сопоставления особых точек на изображениях основаны на эвристиках и поэтому могут выдавать некорректные результаты.
Чем больше доля неправильно найденных пар, тем меньше вероятность того, что положение и ориентация БПЛА будут вычислены верно.
По аналогии с предыдущим разделом необходимо вычислить координаты всех особых точек на самом нижнем слое пирамиды .
Фрагменты снимка с ИСЗ разделены черными горизонтальными и вертикальными линиями, в данном случае количество фрагментов равно 25 .
Граница области поиска показана в виде окружности.
Разрешение камеры на БПЛА выбрано равным 1 024 на 768 пикселей.
Белыми линиями соединены пары соответствующих точек, найденных на снимке с беспилотника и на части спутникового снимка.
В проведенных экспериментах количество таких пар обычно колебалось в диапазоне от 1 000 до 1 500.
На рисунке 3 показаны только 50 пар.
Далее производится ее декомпозиция на матрицу ориентации и вектор положения БПЛА [9].
В рамках экспериментальных исследований комплекса были проведены тестирования модулей, предназначенных для моделирования полета БПЛА и автоматического определения его положения и ориентации.
Одним из результатов моделирования является видеофайл, для каждого его кадра необходимо вычислить положение и ориентацию камеры на беспилотном аппарате в тот момент, когда был выполнен этот кадр.
Эксперименты показали, что максимальная ошибка в определении положения БПЛА составляла не более 67 метров, средняя ошибка около 0,5 метра.
Максимальная ошибка в определении ориентации аппарата по каждой из трех осей вращения  [10] составляла не более 1 градуса, среднее около 0,2 градуса.
Следует заметить, что используемый алгоритм генерации траектории полета порождал такую траекторию, что значение крена всегда равно нулю.
Также было установлено, что реализованные алгоритмы работают достаточно корректно, когда угол тангажа равен примерно 30 градусам и аппарат набирает высоту.
В том случае, когда аппарат снижается, стабильная работа алгоритмов обеспечивается при угле тангажа не более 15 градусов.
Аналитический обзор литературы по машинному  зрению показал, что можно выделить несколько методов для решения этой задачи.
Пусть на снимках с ИСЗ и БПЛА выделено пар соответствующих особых точек.
Каждой особой точке на снимке с беспилотника можно однозначно сопоставить трехмерную координату некоторой точки на поверхности Земли, чьей проекцией на снимке с БПЛА является точка.
Такая информация доступна, если есть возможность использовать карту высот.
Глобальная система координат привязана к камере на спутнике.
Возможно определить и матрицу поворота с помощью кватерниона.
Пусть карта высот недоступна, но на снимке со спутника имеется набор опорных точек, для которых известны их трехмерные координаты .
Предположим, что все опорные точки распределены на карте местности таким образом, что на любом снимке с БПЛА можно обнаружить хотя бы несколько таких точек.
Используя пары соответствующих особых точек, найденных на обоих изображениях некоторым алгоритмом выделения особых точек, можно вычислить так называемую фундаментальную матрицу [11, 12], которую тоже можно разложить на матрицу и вектор [13, 14].
Но в случае с фундаментальной матрицей вектор положения БПЛА можно вычислить только с точностью до некоторого неотрицательного коэффициента, который необходимо определить, используя набор точек.
Рассмотрим метод вычисления положения и ориентации БПЛА, в котором используется предыдущий кадр видеоряда, а также положение и ориентацию БПЛА, вычисленную для предыдущего кадра.
Находим фундаментальную матрицу, связывающую предыдущий и текущий снимки, и производим ее декомпозицию на матрицу и вектор .
Пусть ориентация аппарата в предыдущий момент времени определяется матрицей, а положение вектором.
Что касается изменений времени суток, погодных условий и времени года, то такие изменения характеризуются тем, что существенно меняется текстура поверхности.
Например, если взять два снимка одного и того же участка Земли, один из которых выполнен в июне, а другой в ноябре, то обнаружим на них совершенно разные наборы особых точек.
Пусть доступны несколько спутниковых снимков одного и того же участка Земли, которые выполнены в разное время года, при разных погодных условиях и т.д.
Перед началом полета БПЛА можно выбрать тот снимок с ИСЗ, который наиболее точно соответствует текущим условиям.
Если же есть вероятность, что условия видеосъемки будут меняться в полете, то необходимо поменять текущую карту местности.
Предположим, возникла ситуация, когда алгоритм, который должен обнаруживать множество пар соответствующих особых точек на снимке с БПЛА и на карте местности, в какой-то момент стал находить слишком мало таких пар.
Или же алгоритм, отвечающий за вычисление положения и ориентации БПЛА, начинает выдавать неустойчивое решение, или же вычисленные значения положения и ориентации слишком сильно отличаются от значений, полученных в предыдущий момент времени.
Путем параллельной обработки ряда карт местности выбираем ту карту, которая позволяет получить устойчивое решение, и фиксируем ее.
В заключение отметим, что разработанные алгоритмы позволяют решать задачи моделирования полета БПЛА, а также автоматического определения его положения и ориентации с применением методов, средств и алгоритмов компьютерной графики, технического зрения и параллельных вычислений.
Предложено направление дальнейших исследований: решение задач позиционирования БПЛА при его полете над местностью с ярко выраженным рельефом.
В рамках дальнейшего развития методов и алгоритмов моделирования полета БПЛА необходимо разработать и реализовать набор алгоритмов порождения траектории полета БПЛА, а также ввести обратную связь, позволяющую управлять аппаратом и корректировать курс при отклонении от заданной траектории.
Созданный аппаратнопрограммный комплекс показал достаточную эффективность разработанных алгоритмов в решении поставленных задач.
