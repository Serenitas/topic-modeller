
Генерирование случайных процессов с заданными вероятностной и спектральной мерами является одной из наиболее сложных задач стохастического моделирования [1].
Данное утверждение справедливо для всех законов распределения вероятностей, за исключением нормального распределения, для которого задача моделирования достаточно просто решается для произвольных спектральных мер [2].
До настоящего времени в арсенале исследователей отсутствуют универсальные методы, позволяющие решать эту задачу без существенных ограничений на вид спектральной или вероятностной меры.
Тем не менее, в работе [3] был предложен метод, обладающий достаточной универсальностью по отношению к маргинальному закону распределения вероятностей и  моделируемого стохастического процесса.
Несмотря на столь значимое достоинство, этот метод не получил широкого распространения в силу ряда причин.
Основной причиной, ограничивающей его распространение, является отсутствие исследований точности моделирования АКФ.
В силу особенностей метод обладает специфическим видом погрешности моделирования АКФ.
Эта погрешность является методической и носит систематический характер, а значение погрешности зависит, как это будет показано далее, от множества параметров алгоритма моделирования.
Механизм возникновения погрешности описан авторами метода [3], но каких-либо детальных исследований до сих пор не было проведено.
В данной работе описываются разработка метода оценки точности воспроизведения  заданной АКФ методом перестановок [3] и получение первоначальных сведений о свойствах методической погрешности.
Прежде рассмотрим вариант реализации метода, разработанного авторами этой статьи.
Формирователь представляет собой линейный фильтр, структура и параметры которого однозначно определяются на основании вида АКФ и значений ее параметров.
Методы расчетов таких фильтров известны и подробно описаны, например, в [4].
Как правило, эта процедура состоит из этапа формирования вектора с равномерным распределением с последующим его нелинейным преобразованием.
На рисунке 1 приведена схема с нелинейным преобразованием, хотя в ряде случаев эта схема может изменяться, например для распределения Симпсона.
Формирователь может быть реализован нелинейной функцией или несколькими шагами алгоритма.
Существующие методы позволяют в точности воспроизводить заданные одномерные законы распределения [5].
В частном случае для непрерывных АКФ выражение  можно записать как или.
 Здесь во втором выражении учтено свойство четности АКФ.
Формальный сомножитель, стоящий перед интегралом, может быть исключен, так как оценка точности метода производится в относительном виде, поэтому в дальнейших вычислениях сомножитель не используется.
Приведенное выражение  соответствует непрерывному случаю.
Дальнейшие преобразования приводят к стандартному виду среднеквадратичного отклонения.
Действительно, исключив зависимость значения погрешности от величины корреляционного сдвига и приведя результат к размерности АКФ, получаем.
Рассмотрим их поочередно.
Первая оценка погрешности будет определяться выражением вида.
 Выражение  отображает погрешность моделирования АКФ ведущего процесса.
Таким образом, АКФ стохастического процесса на выходе линейного фильтра полностью определяется импульсной характеристикой последнего, то есть применение выражения  для моделирования не порождает дополнительных погрешностей, за исключением обусловленных реализацией метода [7], которые в первом приближении будем считать незначимыми.
На основании вышеизложенного можно предположить, что основной составляющей в оценке  будет погрешность, обусловленная вариативностью оценок АКФ, то есть она будет носить случайный характер.
Значение этой погрешности сложным образом зависит от длины анализируемого вектора, вида АКФ и значений ее параметров, корреляционного сдвига, но в пределе при погрешность также будет стремиться к нулю .
Следует отметить, что  носит приблизительный характер [8] и верно только в случае выполнения неравенства.
Вторая оценка погрешности будет определяться выражением.
 В данной оценке погрешности присутствуют две составляющие.
Основная из них методическая погрешность, имеющая систематический характер.
Во втором случае  АКФ также будут отличаться, но значительно меньше, и самое главное, это отклонение будет иметь случайный, а не систематический характер, при отклонение будет стремиться к нулю.
Именно эту погрешность авторы метода определили как основную и в работе [3] описали механизм ее возникновения.
Следует отметить одну особенность методической погрешности: она сложным образом зависит от распределений, параметров и вида АКФ.
Кроме того, с изменением параметров АКФ будет изменяться и погрешность.
Такое преобразование изменяет любой закон распределения вероятностей, если он не является нормальным, происходит так называемая нормализация.
Результаты численного эксперимента показаны на рисунке 3.
Результаты проведенного эксперимента показывают, что уменьшение параметра при формировании АКФ вида  приводит к изменению закона распределения выходного процесса, а следовательно, и к росту систематической погрешности.
Можно с большой уверенностью предположить, что данное утверждение является верным для всех законов распределения, за исключением нормального закона, который инвариантен относительно линейного динамического преобразования.
Третья возможная оценка погрешности формирования АКФ будет определяться выражением,  которое определяет расстояние между теоретически заданной АКФ и результатом моделирования.
Именно эта погрешность и представляет наибольший интерес, поскольку характеризует точность конечного результата метода моделирования.
Для анализа методической погрешности и ее зависимости от параметров АКФ необходимо уменьшить влияние случайной составляющей, что можно сделать двумя способами.
Первый способ связан с увеличением интервала наблюдения  и количества параллельных экспериментов с последующим усреднением.
В таком случае при изменении параметра будет изменяться только значение методической погрешности, значение случайной погрешности должно оставаться на одном уровне.
Опишем алгоритм, реализующий предлагаемый метод.
1.
Определяем, до какого значения АКФ проводится анализ погрешности.
Задаем коэффициент кратности, определяющий, во сколько раз длина вектора будет превышать длину корреляционного сдвига.
2.
3.
Округляем полученное значение до ближайшего целого, поскольку корреляционный сдвиг для стохастических процессов, представленных векторами, есть целая величина.
Далее пересчитываем значение с учетом округления.
4.
5.
Для проверки приведенных предположений были выполнены численные эксперименты.
В частности, рассмотрены три характерных случая параметров моделирования, результаты которых приведены ниже.
Такое возможно только при условии, что все три вектора будут иметь нормальное распределение.
В силу того, что у ведущего и ведомого процессов законы распределения совпадают, в результатах моделирования будет отсутствовать методическая погрешность, а применение алгоритма масштабирования длины вектора в зависимости от значения параметра позволит сохранить дисперсию случайной погрешности на одном уровне.
В качестве критериев оценки верности выдвинутого предположения воспользуемся критерием значимости регрессии и критерием АббеЛинника.
Регрессия признается значимой при выполнении условия >.
Критерий АббеЛинника позволяет проверить гипотезу об отсутствии тренда в погрешностях на основе следующей статистики [9]:.
Если, то нет оснований отвергнуть гипотезу, что наблюдаемые значения не содержат тренда, в противном случае считаем, что тренд есть.
Численные значения полученных статистик приведены в таблице, в графическом виде результаты представлены на рисунке 4а.
Как видно из приведенных графиков, оценки погрешности и совпали и, как следствие, совпали линии регрессии.
Это означает, что ведомый процесс практически точно воспроизвел ведущий процесс.
Наблюдаемый на графиках наклон линии регрессии, очевидно, следует отнести к некомпенсированному увеличению вариативности оценки АКФ с уменьшением параметра.
Но использованные статистические критерии значимость наклона не подтверждают , так что можно считать, что разработанный алгоритм масштабирования с поставленной задачей справился.
Наклон линии регрессии погрешности имеет подтверждение значимости по обоим критериям.
Механизм увеличения расстояния между ведущим и ведомым процессами заключается в уменьшении количества вариантов при сглаживании ведущего процесса .
Однако значимого влияния на результат моделирования эта погрешность не имеет, так как на два порядка меньше, чем погрешность.
Эксперимент проведен по аналогии с предыдущим случаем, а результаты расчета статистик представлены в таблице, в графическом виде результаты отображены на рисунке 4б.
Как видно из результатов эксперимента, однозначно говорить о наличии зависимости погрешности моделирования от параметра нельзя.
Действительно, принципиально расстояние между векторами остается неизменным, как и в предыдущем эксперименте, так как законы распределения ведущего и ведомого векторов остаются неизменными.
Наблюдаемый наклон линии регрессии, очевидно, имеет ту же природу, что и в предыдущем случае.
Если выдвинутое предположение верно, то на графиках зависимости погрешностей от параметра будет наблюдаться положительный наклон линий регрессии.
Графики на рисунке 4в подтверждают выдвинутое предположение визуально, а расчет статистик Аббе Линника и Фишера, приведенный в таблице, подтверждает статистическую значимость наклона линии регрессии.
Результаты рассмотренного случая моделирования позволяют говорить о том, что подтверждается модель возникновения погрешности моделирования случайных процессов анализируемым методом перестановок.
Для убедительности рассмотрим еще один случай.
Численные значения полученных статистик приведены в таблице, в графическом виде результаты представлены на рисунке 4г.Как и в предыдущем случае, результирующая погрешность имеет статистически значимый наклон линии регрессии, но этот наклон уже имеет отрицательный знак.
На основании результатов, полученных в данной работе, можно сделать следующие выводы.
Данный метод расчета параметров проведения эксперимента по анализу погрешности моделирования позволяет значительно снизить влияние вариационной составляющей погрешности оценки АКФ, в результате чего появляется возможность выделить методическую составляющую и оценить ее реальный вклад в суммарную погрешность.
Проведенные численные эксперименты показывают, что сделанное предположение о механизме возникновения методической погрешности можно считать верным.
Действительно, в первых двух случаях, когда расстояние между ведущим и ведомым векторами не зависит от параметра АКФ, наклон линии регрессии результирующей погрешности статистически незначим.
Иными словами, погрешность моделирования не зависит от параметра АКФ.
В двух последних случаях расстояние зависит от параметра АКФ и, как следствие, наклон линии регрессии погрешности становится статистически значимым.
Несмотря на наличие методической погрешности, метод имеет очень значимое преимущество, о котором говорилось в начале статьи, отсутствие ограничений на вероятностную и спектральную меру моделируемого случайного процесса.
Очевидно, что можно найти модификации данного метода, позволяющие снизить выявленную методическую погрешность, но это будет задачей дальнейших исследований.
