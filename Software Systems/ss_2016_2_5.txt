Приближенные рассуждения на основе темпоральных нечетких байесовских сетей



Моделирование приближенных рассуждений активно используется при решении задач интеллектуальной поддержки принятия решений , требующих обработки знаний в условиях стохастической и нестохастической неопределенности . Для учета стохастической неопределенности применяются методы и инструменты логико-вероятностного подхода . Для учета нестохастической неопределенности используются положения теории нечетких множеств и нечеткой логики. В данной работе рассмотрены темпоральная нечеткая байесовская сеть (ТНБС) , предоставляющая развитые возможности по представлению знаний с учетом как стохастической, так и нестохастической неопределенности, а также метод приближенных рассуждений на основе этой модели. Описаны разработанные программные средства, реализующие предложенные модель и метод приближенных рассуждений, представлен пример решения задачи анализа динамики психоэмоционального состояния пациентов.

ТНБС – это байесовская сеть доверия, в которой предпосылкой причинно-следственной связи является сложное темпоральное высказывание, а в качестве меры истинности высказываний использу-  ется нечеткая вероятностная мера. Данная модель позволяет как в качественном, так и в количественном виде задавать причинно-следственные отношения с учетом темпоральных зависимостей в условиях стохастической и нестохастической неопределенности.

Для моделирования приближенных рассуждений с использованием ТНБС разработан метод, позволяющий определять значения нечеткой вероятностной меры истинности высказываний вида «Переменная сети x в момент времени t принимает значение x1», где x – произвольная переменная ТНБС; t – произвольный момент времени из интервала моделирования.

Результатом приближенных рассуждений в ТНБС является значение нечеткой вероятностной меры истинности утверждения о нахождении узла сети в одном из его состояний. Сам процесс рассуждений реализуется в виде последовательного перехода между моментами времени и осуществления для каждого момента времени вероятностного вывода в ТНБС. В ходе вероятностного вывода для каждого момента времени при наличии темпоральных зависимостей используются результаты вывода, полученные на предыдущих шагах.

Предлагаемый метод основан, во-первых, на преобразовании ТНБС со сложными темпоральными высказываниями к виду, содержащему лишь простые темпоральные высказывания; во-вторых, на построении дерева сочленений на основе исходной ТНБС; в-третьих, на вычислении искомого распределения нечетких вероятностей посредством передачи сообщений между узлами дерева сочленений, а также на формировании сети временных ограничений для передачи сообщений через неоднородные сепараторы дерева сочленений . Метод позволяет реализовать как прямой, так и обратный вывод и моделировать рассуждения, в которых присутствуют сложные темпоральные высказывания, а в качестве меры истинности высказываний  используется нечеткая вероятностная мера. Схемы прямого и обратного вывода в ТНБС на основе предлагаемого метода представлены на рисунке 1.

В качестве примера использования предлагаемого метода приближенных рассуждений рассмотрим задачу анализа динамики психоэмоционального состояния пациентов, которая решалась на базе Смоленского областного государственного автономного учреждения «Геронтологический центр «Вишенки» . Фрагмент модели психоэмоционального состояния пациентов в виде ТНБС приведен на рисунке 2.

Темпоральные модальности «всегда в прошлом» и «когда-либо в прошлом» представляются символами. Так, выражение обозначает вероятность того, что на интервале времени от узел RT всегда находился в состоянии. Выражение  обозначает вероятность того, что на интервале времени от  узел RT когда-либо находился в состоянии.

Структура сети в ходе моделирования не меняется и не зависит от значений интервалов, для которых задаются темпоральные зависимости. Однако в сеть могут быть внесены свидетельства относительно нахождения тех или иных узлов в различных состояниях.

Для иллюстрации прямого вывода с использованием описанной модели найдем ответ на вопрос «Если известно, что у пациента в течение двух дней будет наблюдаться стабильно высокая личностная и реактивная тревожность, то каково при этом будет его психоэмоциональное состояние?» Априорные значения нечетких вероятностей событий «Реактивная тревожность всегда за последнюю неделю низкая» и «Реактивная тревожность когда-либо за последнюю неделю высокая» представлены в виде нечетких треугольных чисел соответственно. Априорные распределения нечетких вероятностей имеют следующий вид.

Первым этапом вывода является дополнение структуры сети временных ограничений исходя из структуры ТНБС. Обозначим начальный момент времени как t0, тогда состояние сети временных ограничений в начальный момент времени имеет вид.

Далее выполняется алгоритм передачи сообщений в построенном дереве сочленений.

Для вычисления распределения нечетких вероятностей для узла T в качестве временного корня дерева сочленений выбирается узел. На первом шаге узел передает узлу, следующую информацию После того как все листья передали сообщения временному корню, возможен непосредственный расчет распределения нечетких вероятностей для узла T.

Аналогично, назначением временным корнем узла T, D, E и выполнением последующих шагов алгоритма передачи сообщений, находится распределение нечетких вероятностей для узла E.

Для узлов D, RT, LT распределения совпадают с априорно заданными.

Далее сеть временных ограничений дополняется значениями на основе рассчитанных распределений вероятностей. Значения присваиваются соответствующим коннекторам. Элементарные ограничения могут быть активированы, коннекторам  и  будут присвоены значения  и  соответственно.

Переходя к следующему моменту времени необходимо дополнить структуру сети временных ограничений следующими ограничениями.

Расчет распределения вероятностей аналогичен предыдущему шагу с тем исключением, что из сети временных ограничений извлекаются значения нечеткой вероятностной меры истинности высказываний , рассчитанные в сети временных ограничений на предыдущем шаге моделирования. В результате получаем следующие распределения вероятностей (для узлов D, RT, LT распределения совпадают с априорными).

Сеть временных ограничений дополняется значениями нечеткой вероятностной меры, рассчитанными на текущем шаге моделирования, после чего активируются соответствующие элементарные ограничения и становится возможным вычисление и. Данные значения будут использованы в расчетах для последующих моментов времени.

Далее вышеописанные действия повторяются для следующего момента времени.

На рисунке 3 показаны изменения значения нечеткой вероятностной меры истинности высказывания «Имеется патология психоэмоционального состояния пациента» с течением времени, из которого можно сделать вывод о том, насколько возрастает вероятность патологического психоэмоционального состояния пациента при наличии в течение двух дней стабильно высокой личностной и реактивной тревожности.

Обратный вывод в соответствии с предлагаемым методом приближенных рассуждений аналогичен прямому выводу, за исключением порядка активации элементарных ограничений, входящих в состав сети временных ограничений . В качестве примера задачи, для решения которой необходимо применение обратного вывода в ТНБС, можно привести задачу нахождения ответа на следующий вопрос: «Пусть известно, что имеется патология психоэмоционального состояния пациента. Какое состояние личностной тревожности способствует такому психоэмоциональному состоянию?».

Представим программную реализацию приближенных рассуждений на основе ТНБС. На рисунке 4 изображена модульная структура разработанных программных средств для приближенных рассуждений на основе ТНБС .

Модуль визуального редактора содержит классы и элементы графического интерфейса приложения. Модуль описания нечетких чисел содержит иерархию классов, представляющих такие понятия, как нечеткое число, треугольное нечеткое, альфа-уровень нечеткого числа, множество альфауровней нечеткого числа, медиана нечеткого числа. Модуль нечеткой арифметики предоставляет программный интерфейс в виде совокупности интерфейсов и реализующих их классов, которые позволяют проводить арифметические операции с нечеткими числами. Модуль валидации параметров моделирования отвечает за проверку соответствия введенных пользователем исходных данных требованиям выбранного вида моделирования рассуждений. Модуль сети временных ограничений включает в себя ядро сети временных ограничений в виде совокупности классов, представляющих основные элементы сети временных ограничений и реализующих процесс вычислений в данной модели. Модули прямых и обратных рассуждений реализуют предложенный метод приближенных рассуждений. Модуль анализа результатов моделирования рассуждений позволяет проводить интерпретацию результатов моделирования приближенных рассуждений. Модуль визуализации результатов анализа содержит графические компоненты и интерфейсы, реализующие непосредственное представление результатов анализа. Модуль построения и редактирования ТНБС реализует поддержку пользовательских сценариев создания и редактирования ТНБС. Модуль валидации ТНБС  выполняет проверку построенной ТНБС на непротиворечивость и возможность моделирования рассуждений с ее использованием. Модуль описания ТНБС предоставляет пользователю набор классов, реализующих компоненты сети и позволяющих строить экземпляры ТНБС путем задания отношений композиции и агрегации на данном наборе. Модуль доступа к данным необходим для построения слоя абстракций над реляционной моделью данных.

Все описанные модули, кроме инфраструктурного модуля и модуля визуального редактора, входят в состав ядра программной системы и, будучи реализованными в виде динамически подключаемых программных библиотек, могут быть использованы в составе других систем моделирования рассуждений и поддержки принятия решений.

Предусмотрены две роли: инженер по знаниям и эксперт предметной области. Основной задачей инженера по знаниям является взаимодействие со специалистом предметной области с целью систематизации его знаний о предметной области и представления их в виде экземпляра ТНБС. Роль эксперта заключается в разрешении на работу с созданным инженером по знаниям экземпляром ТНБС, а именно: выбор созданной модели, реализация прямого и обратного вывода с использованием выбранной модели, анализ результатов моделирования.

Таким образом, в статье рассмотрены предложенные ТНБС, а также метод приближенных рассуждений на ее основе. Разработанная модель характеризуется расширенными возможностями представления и моделирования темпоральных причинно-следственных зависимостей. Предлагаемый метод приближенных рассуждений позволяет реализовать прямой и обратный выводы с использованием вычислительной модели в виде сети темпоральных ограничений. Приведены примеры использования разработанных модели и метода для анализа динамики психоэмоционального состояния пациентов. Разработаны программные средства, обеспечивающие возможность моделирования приближенных рассуждений в условиях неопределенности с учетом темпоральных аспектов.

