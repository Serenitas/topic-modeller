Автоматизированная система обработки данных в UNIX-подобных системах



Одним из активно развивающихся направлений является использование АСУ при передаче и обработке данных. Подобными вопросами зачастую занимаются дата-центры (центры обработки данных (ЦОД)) . Такие центры работают в крупных городах во многих странах, и их число постоянно растет. ЦОД являются местом для хранения и обработки информации. В них располагаются различные ресурсы, такие как web-сайты, почтовые сервисы, облачные технологии и др. В настоящее время ЦОД нередко подвергаются атакам во внешней глобальной сети, которые могут исходить из любой точки планеты. Расположенное в ЦОД оборудование использует внешние сетевые каналы, что создает потенциальную угрозу информационной безопасности. При этом внешние интернет-ресурсы становятся недоступными для клиентов, например, пользователь не может попасть на свой почтовый сервис или не имеет доступа к нужной веб-странице и т.п.

На оборудовании, размещенном в ЦОД, как правило, установлены операционные системы различных семейств: Windows, Linux, UNIX, Amiga, DOS, Solaris, Illumos, Plan, Inferno . Практически каждая система имеет определенные уязвимости, и нельзя быть застрахованным от DoS- и DDoS-атак, приводящих к нарушению доступности информации и потере пакетов. Правильное распределение информационных потоков по ядрам физического  сервера способствует увеличению пропускной способности при обработке данных в автоматизированном режиме и их сохранении. Распределенномодульная обработка информации в автоматизированном режиме позволяет принимать входящие и исходящие данные на физический сервер до 2,2 GB/s, при этом распределяя потоковую информацию по физическим и логическим ядрам.

Главным требованием к современным технологиям является равномерное распределение выходных данных. Это означает, что упорядоченная входящая информация (например потоковый сетевой трафик) должна преобразовываться автоматически. Подобная система автоматизации должна исключать энтропию преобразуемых данных .

Вопросами изменения автоматизированных информационных систем занимаются уже продолжительное время, и сегодня данным исследованиям посвящено огромное количество публикаций . Одна из первых работ датируется 1980 годом. Ее авторами являются сотрудники корпорации IBM . С тех пор автоматизации обрабатываемой информации придается огромное значение. В таких системах зачастую предлагаются устаревшие подходы к решению поставленной задачи, нагружающие вычислительные ресурсы . Среднегодовая нагрузка на физические данные ЭВМ имеет тенденцию к ежегодному росту . При огромных потоках информации увеличивается риск потери доступности данных, находящихся на вычислительных ресурсах, которые имеют доступ во внешнюю глобальную сеть. Подобный эффект объясняется затруднениями в выявлении и классификации таких угроз, а также сложностью привязки их к конкретным процессам взаимодействия приложений в логируемых файлах .

В статье описана разработка аппаратно-программного комплекса (АПК) для обработки массивной и многопоточной информации (атака сетевым трафиком, парсинг, различные подключения от пользователей и т.п.) с последующим занесением данных в СУБД MySQL, почтовым и SMS-уведомлением, а также с выводом в web-интерфейс и распределением сетевой нагрузки по физическим и логическим ядрам сервера.

Преимущества и научная новизна 

Основные преимущества предлагаемого решения:  возможность распределения входящих информационных потоков (сетевой нагрузки) по ядрам физического сервера;  увеличение пропускной способности СУБД MySQL;  уведомление по SMS на мобильный телефон, а также на электронную почту;  возможность удаленного управления АПК через web-интерфейс;  увеличение сетевой пропускной способности (входящих и исходящих сетевых пакетов);  использование цепей Маркова, впервые доработанных для распределения сетевой нагрузки.

Научная новизна заключается в распределении сетевой нагрузки по физическим ядрам сервера за счет доработки цепей Маркова, что показано на рисунках 1 и 2.

Таким образом, АПК не только позволяет снизить сетевую нагрузку на вычислительные ресурсы, но и способствует своевременному уведомлению (о состоянии ЭВМ) по SMS на мобильный телефон.

Аппаратно-программные (автоматизированные) системы обработки данных (СОД) предназначены для создания информационных ресурсов (вычислительные кластеры). Обработка данных происходит на физическом (аппаратном) уровне. Аппаратно-программные СОД могут быть следующими.

1. Одномашинные СОД. Данное решение реализовано за счет единственной ЭВМ (физического сервера) с однопроцессорной структуризацией. Существенными недостатками разработанной системы являются ограничение производительности (до 10 млн операций в секунду), а также отсутствие  многопоточности приема входящего сетевого трафика . В связи с этими недостатками возможен простой системы до 2–3 минут в сутки (по причине отказа в обслуживании оборудования). Структура одномашинной СОД представлена на рисунке 3.

2. Многомашинные СОД (вычислительные комплексы). Это решение предполагает связку нескольких физических серверов в единое целое. Данные вычислительные комплексы подразделяются на два вида: с прямой (рис. 4) и с косвенной (рис. 5) связями между ЭВМ. В СОД с косвенной связью взаимодействие происходит через общее запоминающее устройство (доступ с общим набором данных). В СОД с прямой связью процессы, отвечающие за работу с информацией, имеют доступ ко всему объему данных . Данные СОД являются базовыми средствами обработки информации. В связи с этим в них включено универсальное и стандартизированное (общесистемное) ПО.

Существенным недостатком многомашинной СОД с косвенной связью является низкая пропускная способность принятия и обработки данных . Минус многомашинной СОД с прямой связью: при выходе из строя одной из составляющих (физический сервер) замедляется скорость принятия и обработки данных.

3. СОД, настроенные на заданную область применения (вычислительные системы). Схема работы вычислительных систем показана на рисунке 6.

Все эти СОД основаны на взаимодействии между физическими серверами и вычислительными кластерами. Как правило, такие СОД включают в себя ПО и технические средства, ориентированные на решение определенных поставленных задач . СОД (вычислительные комплексы) подразделяются на два вида:  вычислительные системы на основе ЭВМ и вычислительных комплексов общего применения;  вычислительные системы на основе специализированных ЭВМ и вычислительных комплексов.

Недостатком вышеприведенных видов СОД является возможность загрузки ресурсов центрального процессора, что может привести к отказу и задержке обработки данных .

4. Системы телеобработки (ТС). Данное решение предназначено для передачи данных по каналам связи: происходит взаимодействие пользователей с системой за счет терминалов связи (абонентских пунктов). Абонентские пункты подключаются через каналы связи к средствам обработки данных на ЭВМ . Схема работы СОД ТС представлена на рисунке 7.

Существенным недостатком подобного рода СОД является невозможность программного расширения пропускной способности канала для увеличения объема принимаемой и обрабатываемой информации.

Разработка и реализация автоматизированной обработки информации 

Система SDP (Speed data processing) – разрабатываемый АПК, предназначенный для массивной и многопоточной обработки информации в автоматизированном режиме. Отличительной особенностью реализуемого АПК является наличие web-интерфейса и отправки полученных данных в СУБД MySQL. Структура и принципиальная схема работы SDP представлены на рисунках 8 и 9.

Все объекты, приведенные на рисунке 9, взаимодействуют друг с другом.

Канал передачи данных в СУБД MySQL расширен до 2,2 GB/s. Подобный эффект объясняется необходимостью логирования всех действий, в том числе и при сетевых атаках, в ходе которых происходит запись всех входящих и исходящих сетевых пакетов. В качестве передаваемых данных используются получаемые сведения о состоянии ЭВМ, входящие и исходящие сетевые пакеты (их количество, IP-адреса и т.п.), а также все происходящие на физическом сервере действия.

Разрабатываемый функционал и теоретическая нагрузка отражены в таблице 1.

Представим фрагмент исходного кода, реализованный на языке программирования BASH и предназначенный для прямого уведомления (на почтовый ящик) о нагрузке на центральный процессор (CPU) и основных запускаемых процессах.

Фрагмент исходного кода, разработанный на языке программирования BASH, представляет собой очистку логируемых файлов после какой-либо DoS- и DDoS-атаки.

Далее приведена часть исходного кода, созданная на языке программирования PHP и отвечающая за вызов функций в web-интерфейсе.

Фрагмент исходного кода, написанный на языке программирования высокого уровня C и отвечающий за распределение сетевой нагрузки по потокам.

Примеры SMS-уведомлений.

 В случае стабильной работы физического сервера (приходит ежечасное оповещение на мобильное устройство): Дата: 10.08.2016; Время: 12:00; Размер потребляемого трафика на данный момент: 9 ТВ; Текущая нагрузка: 5 %, в пределах нормы; Состояние кластера стабильное.

 При каком-либо сбое ЭВМ, а также при наличии сетевой атаки.

Тестирование АПК 

После подготовки алгоритма и написания кода АПК SDP необходимо произвести его тестирование для получения значений нагрузки на вычислительные ресурсы физического сервера в двух режимах – обычном и боевом. Обычный режим работы проявляется при упорядоченной (нормализованной) работе ЭВМ без воздействия внешних факторов. Под боевой работой подразумевается работоспособность ЭВМ с применением вредоносного сетевого трафика, направленного на нарушение удаленной работы серверного пространства.

Нагрузка на физические ресурсы ЭВМ при отсутствии каких-либо внешних факторов (обычный режим) представлена в таблицах 2 и 3.

В данных таблицах приняты следующие сокращения: А – количество обрабатываемой информации, MB/s; B – количество потоков, шт./с; C – нагрузка при старте, %; D – нагрузка при рестарте, %; E – нагрузка при обработке информации, %; F – входящие сетевые пакеты, млн шт./с.

Средняя нагрузка из данных таблиц 2 и 3 показывает достаточно низкие результаты: центральный процессор – 0,77 %, SSD-накопитель – 0,53 %, оперативная память – 0,15 %.

Полученные данные (табл. 2, 3) позволяют констатировать, что нагрузка на вычислительные ресурсы ЭВМ достаточно низкая и предоставляет возможность широкомасштабной обработки данных с последующей стабилизацией серверной рабочей среды.

Нагрузка на ресурсы физического сервера при интенсивной атаке вредоносным сетевым трафиком (DoS и DDoS) показана в таблицах 4 и 5.

В данных таблицах приняты следующие обозначения: А – количество обрабатываемой информации, GB/s; B – количество потоков, шт./с; C – скорость атаки, GB/s; D – входящие сетевые пакеты, млн шт./с; E – нагрузка при старте, %; F – нагрузка при рестарте, %; G – нагрузка при обработке информации, %; H – нагрузка при отправке данных в СУБД MySQL, %.

Средняя нагрузка (табл. 4, 5) остается достаточно низкой при многопоточной обработке информации большого объема: центральный процессор – 7,00 %, SSD-накопитель – 3,14 %, оперативная память – 0,75 %.

Результаты, приведенные в таблицах 4 и 5, свидетельствуют о высокой производительности АПК SDP. Таким образом, разработанный комплекс позволяет обрабатывать значительный объем информации и в режиме реального времени отправлять его в СУБД MySQL. Также появляется возможность запуска сложных вычислительных процессов без нарушения рабочей среды ЭВМ и при достаточно высокой производительности разработанного АПК.

Тестирование АПК SDP проводилось на следующем оборудовании: процессор 2xIntel Xeon 5670 (24 потока); оперативная память – 32 GB; винчестеры – RAID 10 (Intel S3710 SSDSC2BA012T401 800 GB каждый); суммарный сетевой канал – 5 GB/s; операционная система UBUNTU 14.04.

После апробации в течение одного месяца АПК SDP был окончательно инсталлирован на физический сервер в ЦОД (в г. Москва) на оборудование со следующими характеристиками: количество физических серверов – 30; процессор Intel Xeon 5660 (CPU – 60, физических ядер – 360, количество потоков – 720); оперативная память – 960 GB; винчестеры – RAID 10 (Intel S3710 SSDSC2BA012T401 800 GB каждый); внешний сетевой канал – 20 GB/s.

Заключение 

В ходе проведенных исследований и разработок получены следующие результаты.

Разработан АПК по обработке потоковой информации в больших объемах. Это способствует совершенствованию пропускной способности между физическим сервером и реляционной БД MySQL.

Обоснована целесообразность применения АПК SDP на вычислительных ресурсах различной мощности. Предложена методика для упорядоченной и последовательной обработки информации на серверных вычислительных ресурсах.

Проведено множество тестирований, позволяющих определить эффективность работы АПК SDP. Средняя нагрузка на ресурсы центрального процессора варьируется от 0,77 % до 7,00 %. Данная тенденция предоставляет возможность запуска вычислительных процессов различного уровня, а также создает производительную рабочую среду, несмотря на большой поток обрабатываемой информации (до 2,2 GB/s). Загруженность твердотельного накопителя (SSD) колеблется в диапазоне от 0,53 до 3,14 %. Небольшая нагрузка на ячейки Solid-State Drive предоставляет возможность увеличения пропускной способности информационного канала передачи данных. Среднее потребление оперативной памяти составляет от 0,15 % до 0,75 %. Низкая нагрузка на вычислительные ресурсы позволяет выполнять скоростную обработку информации в автоматизированном режиме с последующим уведомлением (на выбор) системного администратора.

Таким образом, выявлена, проанализирована и исследована рабочая среда физического сервера с последующим переходом в кластер. Удобство в управлении и обработка информации на серверных вычислительных ресурсах позволили организовать стабильную работу ЭВМ.

