
Повышение качества листового стекла играет ключевую роль в росте конкурентоспособности продукции стекольных предприятий, обеспечивающей их эффективное функционирование.
Производство листового стекла флоат-способом состоит из совокупности непрерывных стадий, включающих подготовку шихты [1], стекловарение, формование ленты стекла на расплаве олова [2], отжиг ленты стекла, ее резку на листы заданного размера и упаковку.
Для стадий стекловарения и формования ленты стекла характерны сложные взаимосвязанные химические окислительно-восстановительные реакции и процессы тепломассопереноса [3], которые могут привести к нарушению параметров  и возникновению нежелательных оптических и физических дефектов в стекле.
Поэтому актуальным является автоматизация ТП, способствующая выявлению причин возникновения дефектов в стекле в режиме реального времени.
Программный комплекс идентификации точечных дефектов листового стекла обеспечивает функционирование средств сбора информации с датчиков и видеокамер, АСУ резкой ленты стекла, АРМ технолога и оператора.
Взаимодействие указанных компонентов осуществляется через БД  и общую БД производства.
БД РВ поддерживает синхронизацию, репликацию данных и их резервирование для обеспечения отказоустойчивости в реальном масштабе времени протекания ТП.
Общая БД производства обеспечивает с помощью АРМ начальника производства и АРМ технолога решение задач АСУ производством MES-системы.
АРМ оператора являются составной частью соответствующих АСУ ТП и обеспечивают решение задач оперативного операторского управления соответствующих ТП.
БД РВ обеспечивает взаимодействие комплекса программ, АСУ резки и упаковки листового стекла и АРМ оператора.
На промышленном компьютере АСУ резкой и упаковкой листового стекла решается задача оптимизации раскроя ленты стекла с учетом производственного задания и размещения на ленте стекла выявленных дефектов.
БД РВ за счет быстрого обмена информацией обеспечивает оперативное решение задачи оптимизации раскроя ленты стекла.
Структура и состав комплекса программ, функционирующего в режимах настройки и идентификации точечных дефектов в реальном масштабе времени, приведены на рисунке 2.
Рассмотрим функционирование программного комплекса в режиме идентификации точечных дефектов, которое выполняется непрерывно в реальном масштабе времени.
Модуль П1М1 обеспечивает последовательный захват изображений с каждой из линейных видеокамер, количество которых определяется максимальной шириной ленты стекла [4].
Каждое из изображений для снижения шума обрабатывается в модуле П1М2 с помощью сглаживающих фильтров камер.
Далее выполняется нормализация амплитуды полученных изображений от 0 до 1.
Обработанные таким образом изображения формируются в единый кадр в модуле П1М3, обеспечивающем стыковку краев изображений.
В модуле П1М4 вычисляется максимальная яркость изображения, которая затем сравнивается с заданным эталонным значением яркости подсветки.
При систематическом снижении яркости изображения запускается Программа управления подсветкой  для коррекции настроек системы подсветки.
Эти координаты оперативно считываются из БД РВ задачей оптимизации раскроя ленты стекла, функционирующей на промышленном компьютере АСУ резкой и упаковкой листового стекла.
Модуль П2М1 обеспечивает вейвлет-преобразование сигнала [4], полученного из программы П1, а модуль П2М2 анализирует полученное преобразование на наличие неоднородностей, которые выявляются путем пропускания полученного сигнала через систему фильтров, исключающих периодическую составляющую сигнала и определяющих область с неоднородностью.
Далее устанавливаются координаты появления и окончания неоднородности и вычисляется среднее значение амплитуды яркости неоднородного участка вейвлет-преобразования сигнала [4].
Затем модуль П2М2 формирует сообщение программе П1 о готовности к обработке следующего кадра.
Если при выполнении П2М2 выявлена неоднородность, информация о ней передается в модуль П2М3, в противном случае обрабатывается новый кадр.
При выявлении очередной неоднородности модуль П2М3 определяет ее координаты и накапливает в соответствующем динамическом массиве.
Если при очередном цикле анализа неоднородность не обнаружилась, значит, контур сформирован [4].
Информация о точках контура передается в модуль П2М4.
Модуль П2М4 определяет геометрические характеристики выявленного точечного дефекта и формирует транзакции для записи их и параметров яркости дефекта в БД РВ.
Модулем П3М1 осуществляется преобразование растрового контура в векторную форму, которая далее преобразуется в совокупность скалярных значений для передачи во входной слой .
В модуле П3М2 определяется тип контура дефекта, который соответствует конкретному номеру возбужденного нейрона сети.
Первый выход сети соответствует типу гладкий контур, второй типу контур с изломами [5].
Для передачи в БД РВ результатов классификации модуль П3М2 формирует транзакцию, на основе которой СУБД РВ выполняет группу последовательных операций с содержимым БД.
В момент начальной настройки системы и ввода ее в эксплуатацию необходимо обучить сеть распознаванию контуров дефектов по первоначальным образцам в режиме тестового функционирования.
При изменении режимов производства стекла необходимо проводить переобучение ИНС.
Модуль П3М3 обеспечивает выполнение ее обучения в режиме настройки программного комплекса по алгоритму обратного распространения ошибки [5].
Программа идентификации дефекта  определяет тип дефекта на основе результатов работы программ П2 и П3, которые загружаются из БД РВ.
Модуль П4М1 считывает из БД РВ параметры яркости точечного дефекта и обрабатывает их, в результате определяется интенсивность пропускания светового потока ядром дефекта, используемая в качестве исходных данных для  идентификации типа дефекта.
Дополнительными данными являются наличие искажений вокруг ядра, форма ядра, тип контура, размеры ядра  и общие размеры дефекта [5].
Модуль П4М2 реализует ЭС продукционного типа [68], функционирующую в режиме РВ.
Для этого разработана специализированная оболочка ЭС на языке C++ в MS Visual Studio.
База знаний содержит семь правил определения типов дефектов, на основе которых определяются типы дефектов, такие как пузырь, свиль, сульфатный пузырь, включение, матовость поверхности, капля олова и оксид олова [5].
Результаты идентификации дефекта сохраняются в БД РВ.
Для записи полной информации о выявленном дефекте в БД производства листового стекла системой управления БД РВ формируется транзакция.
Полученная информация используется в АРМ технолога и начальника производства, а также системой менеджмента качества предприятия.
В случае возникновения неизвестных ранее дефектов модуль П4М3 предоставляет в режиме настройки программного комплекса возможность редактирования и добавления правил в базу знаний ЭС.
Программа управления подсветкой  реализована на промышленном контроллере Simatic S7-1214 с помощью среды разработки TIA Portal.
Модуль П5М1 в режиме реального времени считывает данные с датчиков освещенности и скорости движения ленты стекла и сравнивает их значения с заданными настройками.
При получении сообщения от программы П1 при систематическом снижении яркости изображения или изменении цвета стекла модуль П5М2 вычисляет новые настройки для системы подсветки в режиме настройки программного комплекса.
Модуль П5М3 управляет яркостью подсветки в автоматическом режиме в соответствии с заданными настройками.
При функционировании рассматриваемого комплекса программ в режиме настройки работают модули П3М3, П4М3 и П5М2.
В этом режиме комплекс программ в качестве сервера взаимодействует с клиентской частью, исполняющейся на АРМ технолога , в которой реализованы пользовательские интерфейсы.
Пользовательский интерфейс программы П4 в режиме настройки показан на рисунке 3.
Пользовательский интерфейс АРМ технолога при анализе характеристик дефектов листового стекла приведен на рисунке 4.
Общее время локализации дефекта составляет от 0,1 до 1 с в зависимости от длины области дефекта .
Система идентификации точечных дефектов листового стекла расположена в 5 метрах от станции резки ленты стекла.
При скорости ленты стекла 0,25 м/с при ее толщине 3 мм  для прохождения стеклом этого расстояния требуется не менее 20 с.
На решение задачи оптимизации раскроя ленты стекла с учетом производственного задания и размещения на ленте стекла выявленных дефектов требуется не более 5 с.
БД РВ программного комплекса реализована на основе СУБД Oracle Time Ten.
С ней взаимодействует автоматизированная система управления резкой и упаковкой стекла при оптимизации раскроя ленты стекла в РВ.
Полная информация о дефектах архивируется и сохраняется в БД производства, реализованной на СУБД MS SQL и SCADA-системы WinCC компании Siemens.
ПО программ П1, П2, П3 и П4 реализовано на языке C++ в MS Visual Studio и исполняется на промышленном компьютере на базе отказоустойчивого двухпроцессорного сервера Fastwel AdvantiX IS-4U-SYS5.
В заключение отметим, что разработанный комплекс программ идентификации точечных дефектов листового стекла создан на основе применения серийно производимых промышленностью аппаратных средств, предложенных оригинальных алгоритмов и сред разработки ПО.
Комплекс программ обеспечивает идентификацию наиболее часто встречающихся типов дефектов листового стекла.
На основе полученных данных формируется электронная карта дефектов, которая используется для автоматического раскроя ленты стекла.
