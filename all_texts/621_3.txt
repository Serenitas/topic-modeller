Разработку долгосрочных программ развития
энергетики с учетом фактора неопределенности
(неоднозначности) исходной информации и условий развития  необходимо проводить на основе
общеэнергетических исследований  с применением специальных методов, моделей, БД, вычислительных средств. В моделях должен рассматриваться длительный период времени (до 30–40 лет)
с выделением нескольких этапов развития и функционирования систем энергетики. Также в моделях
в явном виде должна учитываться дискретность вариантов развития объектов и систем энергетики.
Используемые для формирования вариантов развития энергетики и последующего их анализа инструменты должны быть хорошо обоснованными (то
есть давать доказательные утверждения) и гибкими. Их основу должны составлять некоторые общие организующие исследования, алгоритмы формирования и отбора вариантов. При этом следует
допускать возможность применения разных расчетных схем и моделей для исследования конкретных проблем.
Эффективным инструментом для анализа отдельных вариантов развития энергетики стала балансовая экономико-математическая модель топливно-энергетического комплекса (ТЭК) . По
принципам построения и приемам описания связей
и свойств систем энергетики данная модель похожа
на обобщенную сетевую модель систем энергетики
США , а по своим возможностям она не уступает
ни модели развития электроэнергетики и теплоснабжения в рамках ТЭК страны EPOS  (часть
модельно-информационного комплекса SCANER
,
MESSAGE , Balmorel
.
Данная модель ТЭК позволяет рассматривать
энергетику страны как единое целое от производства энергетических ресурсов до потребления конечных энергоносителей в основных отраслях экономики, включая все стадии переработки и преобразования энергоресурсов, а также исследовать
процесс развития технологической и территориальной структуры энергетики.
Модель ТЭК включает в себя модели основных
систем энергетики: газоснабжения, углеснабжения, нефте- и нефтепродуктоснабжения, электроэнергетики. Наряду с производственным и распределительным (транспортным) блоками присутствует блок потребления, в котором представлены
основные потребители продукции отраслей ТЭК,
ранжированные по соответствующим категориям.
В ходе разработки методики поиска рациональных путей развития ТЭК с учетом требований энергетической безопасности (ЭБ) стало очевидно, что
в рамках одной модели ТЭК невозможно рассмотреть и описать все характерные сочетания внешних
условий с вариантами развития и функционирования ТЭК с учетом неопределенности, воздействия
угроз ЭБ и прочих факторов. Это приводит к большому числу расчетных состояний ТЭК, что может
создавать существенные трудности при формировании и анализе классическими методами исследования. Для решения этой проблемы были использованы методы комбинаторного моделирования,
которые, являясь наглядной формой представления
динамических дискретных ветвящихся альтернатив, позволяют имитировать долгосрочный процесс развития исследуемой системы при различных возможных внешних и внутренних условиях,
учитывая дискретность будущих состояний системы, определять рациональную стратегию развития исследуемой системы.
В данной статье описывается программное
обеспечение, реализующее некоторые процедуры
комбинаторного моделирования, а в качестве примера рассмотрено их применение для исследования
проблем устойчивого развития ТЭК Вьетнама.
Формирование вариантов
развития ТЭК методами
комбинаторного моделирования
Основу комбинаторного моделирования составляет представление развития каждого объекта моделируемой системы в форме направленного
графа, узлы которого соответствуют возможным
состояниям объекта в отдельные моменты времени, а связи характеризуют допустимость переходов из одного состояния в другое. Формирование и
анализ вариантов развития системы в целом проводится путем рассмотрения различных сочетаний
состояний и переходов отдельных объектов, поэтому такой подход был назван комбинаторным
моделированием .
Под объектами понимаются структурные единицы моделируемой системы, рассматриваемые
как единое целое. Это могут быть предприятия или
совокупности однотипных предприятий отраслей
ТЭК, предприятия-потребители энергоресурсов
или обобщенно некоторые наборы (категории) потребителей. Степень агрегирования в выделении
объектов предопределяется постановкой решаемой
проблемы и возможностями информационного
обеспечения. Причем в рамках рассматриваемого
подхода можно естественным образом проводить
объединение объектов. Совокупность нескольких
объектов в одной задаче может образовать единый
объект при рассмотрении более крупных проблем.
На первом этапе исследования создается так
называемый базовый граф развития ТЭК, содержащий по одному узлу для каждого опорного года
(интервала времени T). С каждым узлом связывается основная информация для создания возможных состояний ТЭК со своими особенностями
топливо- и энергоснабжения потребителей. На рисунке 1 представлен базовый граф для трех моментов времени, где в центре кругов показаны номера
узлов. Узел с номером 0 описывает начальное состояние ТЭК.
На втором этапе структура ТЭК разбивается на
несколько составляющих частей (объектов), например, по территориальному или отраслевому признаку. Для каждого объекта экспертами строится
свой граф изменений их параметров по опорным
годам, который должен иметь один исходный узел,
описывающий начальное состояние объекта.
На рисунке 2 показаны графы развития двух систем энергетики. Исходные узлы, соответствующие моменту времени 0, не имеют номера, так как
в последующей генерации графа развития ТЭК
участия не принимают.

На третьем этапе строится граф развития ТЭК
путем комбинирования информации об изменениях параметров различных частей ТЭК, принадлежащих одному временному срезу, и наложения
полученного набора изменений на базовую информацию, связанную с соответствующим узлом базового графа. Таким образом, получается множество
возможных состояний ТЭК для определенного момента времени, полученные состояния ТЭК связываются между собой дугами-переходами.
На основе комбинирования узлов и дуг графов
(рис. 1 и 2) создается граф развития ТЭК, представленный на рисунке 3, где над его узлами показаны
сочетания комбинируемых номеров узлов. В центре узлов указаны номера сгенерированных возможных состояний ТЭК (узлов графа развития
ТЭК).


Все пути развития ТЭК начинаются из единого
начального состояния ТЭК, которое является исходным узлом базового графа (рис. 1).
На четвертом этапе от исходного узла будет
осуществляться проход по графу для оценки допустимости состояний и переходов в графе развития
ТЭК, так как не всякие возможные состояния и переходы в графе могут быть допустимыми. Для этой
цели в комбинаторном моделировании присутствуют общесистемные ограничения, среди которых можно выделить два типа:
 логические условия; некоторые варианты в
развитии одного объекта могут осуществляться
только при реализации определенных вариантов в
развитии других объектов;
 балансовые и другие расчетные ограничения; это ограничения на объемы использования лимитированных ресурсов и производимой продукции для каждого момента времени и каждого перехода; такие ограничения могут быть заданы в виде
балансовых уравнений или неравенств.
Для реализации логических условий используются списки пар несовместных узлов. Парой несовместных узлов называется пара узлов, принадлежащих графам развития различных объектов моделируемой системы, сочетание которых в возможном
состоянии системы по каким-либо причинам невозможно или не имеет смысла.
Представленная выше балансовая экономикоматематическая модель ТЭК относится ко второму
типу общесистемных ограничений. Допустимость
возможного состояния ТЭК напрямую зависит от
корректности результатов расчета на ней.

Уровень ЭБ в любом возможном состоянии
ТЭК для выполнения требований ЭБ может оцениваться с использованием аппарата индикаторов.
Значения индикаторов ЭБ вычисляются на основе
результатов расчета на модели ТЭК. Уровень ЭБ
определяется путем сравнения значений индикаторов и их пороговых значений.
В графе развития ТЭК, представленном на рисунке 3, проверку допустимости по разным причинам не прошли четыре узла (рис. 4).

На пятом этапе строится граф развития ТЭК, содержащий допустимые состояния и переходы. Сначала проходом от исходного до конечных узлов
определяются состояния и переходы, недостижимые из начального состояния. Затем обратным
проходом определяются тупиковые состояния и
переходы, по которым невозможно построить пути
развития ТЭК от начального до последнего момента
интервала времени T. Недопустимые, недостижимые и тупиковые состояния и переходы удаляются
из графа развития ТЭК.
На последнем этапе в графе развития ТЭК по
какому-либо критерию путем поиска кратчайших
путей из исходного узла до конечных формируется
множество оптимальных и близких к ним путей
развития ТЭК. На рисунке 5 показан граф развития
ТЭК, содержащий допустимые состояния и переходы и сформированный на основе графа, представленного на рисунке 4. На нем узлы и дуги
оптимального пути, обеспечивающего минимум
затрат на развитие и функционирование ТЭК, выделены жирными линиями.
Основная проблема алгоритмов комбинаторного моделирования при их реализации заключается в необходимости рассмотрения большого
числа состояний и переходов в развитии моделируемой системы. Число это возрастает экспоненциально с ростом числа выделяемых объектов и их

состояний. Применение этого подхода возможно
только при наличии возможностей по скоростной
обработке больших объемов данных, что в настоящее время обеспечивается организацией распределенных вычислений, а также за счет использования
экономных алгоритмов расчета. Существенное
значение имеют разумное агрегирование объектов
и состояний моделируемой системы на этапе задания исходной информации, а также организация
процесса выделения допустимых вариантов.
Пакет прикладных программ
«Корректива»
Вышеописанные процедуры формирования и
анализа вариантов развития ТЭК реализованы в

виде пакета прикладных программ «Корректива»
, в котором можно выделить следующие основные программные модули:
 модуль формирования базовых сценариев
развития ТЭК (m1);
 модуль создания графа развития ТЭК (m2);
 модуль оценки допустимости состояния
ТЭК (m3);
 модуль поддержки экспертного анализа
множества оптимальных и близких к ним путей
развития ТЭК (m4).
Информационно-логические связи объектов
предметной области пакета представлены на рисунке 6 в виде двудольного ориентированного
графа. Модули m1, m2, m3, m4 представлены серыми
овалами, а входные и выходные параметры –
окружностями.
Основной задачей модуля m1 является чтение
информации U из БД и формирование на ее основе
согласно целям исследования одного из конкретных сценариев развития ТЭК W. Блок исходной информации U содержит множество исследуемых
стратегий развития ТЭК и может включать перечень критических ситуаций (сценариев возмущений), которые могут возникнуть в течение периода
времени Т вследствие реализации угроз ЭБ, и набор
индикаторов ЭБ.
Модуль m2 реализует методы комбинаторного
моделирования, отвечающие за формирование
графа развития ТЭК и его обход. Сценарий развития ТЭК W модулем m2 преобразуется в базовый
граф развития ТЭК.

Стратегии развития ТЭК, сценарии возмущений реализуются изменением по определенным
законам значений компонент матриц и векторов,
составляющих систему уравнений модели ТЭК.
Подобным образом модуль m2 на основе базовых
состояний ТЭК создает выходное множество P,
состоящее из возможных состояний ТЭК.
Ядро модуля m2 представляет собой несколько
десятков скриптов на интерпретируемом языке
программирования Lua , который
создает новое состояние ТЭК. Генератор моделей
(рис. 7) управляется набором правил, преобразующих данные сценария развития ТЭК W в векторы и
матрицу A уравнений. Исследователь имеет возможность изменять правила преобразования исходной информации.

Модуль m3 проводит оценку допустимости состояния ТЭК из множества P с помощью многоступенчатой системы ограничений. На первом этапе
происходит проверка логических условий. На втором этапе осуществляется решение модели ТЭК
как задачи линейного программирования. Если решение существует, то далее в случае необходимости на основе результатов решения вычисляются
значения индикаторов ЭБ и осуществляется проверка уровня ЭБ.
Результаты работы системы ограничений модуля m3, добавляясь к P0, P1, P2, PK, образуют выходное множество Q, состоящее из проверенных
состояний ТЭК Q0, Q1, Q2, QK.
Модуль m4 на основе полученного множества
Q0, Q1, Q2, QK формирует граф развития ТЭК, содержащий допустимые состояния и переходы, а
также множество оптимальных и близких к ним путей развития ТЭК, с которым далее работает исследователь с целью проведения детального анализа.
После создания графа развития ТЭК каждый
его узел является полностью независимым от других с точки зрения проведения расчетов, что обеспечивает возможность организации на данном
этапе многовариантных расчетов с параллелизмом
по данным , ориентированный на автоматизацию разработки и применения
распределенных пакетов прикладных программ в
разнородных распределенных вычислительных
средах.
Моделирование устойчивого развития
ТЭК Вьетнама
На базе описанной выше модели ТЭК в период
с 2011 по 2015 гг. в ходе совместных исследований,
проведенных Институтом систем энергетики им.
Л.А. Мелентьева Сибирского отделения Российской академии наук и Институтом энергетической
науки Вьетнамской академии науки и технологий,
была разработана модель развития ТЭК Вьетнама
. В ней структура ТЭК представлена по восьми
агрегированным регионам: дельта Красной реки,
Северо-Восточный, Северо-Западный, север Центрального побережья, юг Центрального побережья,
Центральное нагорье, Юго-Восточный и дельта
Меконга. Входные данные модели включают в
себя технико-экономические показатели энергоснабжения (затраты, стоимость и объемы производства, импорта и экспорта), преобразования и
транспорта энергоресурсов, потребления энергоресурсов по видам, включая уголь, нефть, газ и электроэнергию.
Институтом энергетической науки с помощью
специализированного модуля m1 программного пакета «Корректива»  в 2015 г. были проведены
исследования устойчивого развития энергетики
Вьетнама и его энергетической безопасности с
2015 по 2030 гг. Варианты развития энергетики
формировались на основе шести представительных
наборов изменений параметров ТЭК для 2020, 2025
и 2030 гг. Изменению подвергался верхний предел
возможностей следующих отраслей ТЭК: добыча
угля, добыча природного газа, выработка электроэнергии на ГЭС. Перечисленные параметры менялись в границах от –10 % до 10 % от исходного значения.
Для оценки устойчивого развития национальной энергетики были выбраны 16 индикаторов ЭБ
и 24 критерия устойчивого развития. На их базе с
помощью метода анализа иерархий  были выбраны четыре варианта развития ТЭК. В результате
экспертного анализа наилучшим был признан вариант, где в 2020 г. возможности по добыче угля
снижены на 10 %, возможности по добыче природного газа увеличены на 10 %, а в 2025 и 2030 гг.
развитие ТЭК идет по базовому варианту.
Используя те же предпосылки и данные, для
формирования и анализа вариантов развития ТЭК
Вьетнама были применены алгоритмы комбинаторного моделирования.
На первом этапе на основе исходных данных
был создан базовый граф развития ТЭК. На втором
этапе для сочетаний отраслей ТЭК и регионов
Вьетнама, отмеченных знаком + в таблице, были
построены графы развития, подобные графу развития объекта, приведенному на рисунке 8. В узлах
графа показаны изменения верхнего предела возможностей отрасли ТЭК по отношению к значению, заданному в базовом графе.

На третьем этапе был создан граф развития
ТЭК, содержащий 531 442 узла. Их обсчет на четвертом этапе проводился в распределенной вычислительной среде, состоящей из вычислительных
узлов высокопроизводительного вычислительного
кластера «Академик В.М. Матросов» .
После расчета на модели ТЭК Вьетнама для
проверки уровня ЭБ использовались два региональных индикатора ЭБ: доля собственных источников в балансе котельно-печного топлива и доминирующего ресурса в структуре этого топлива .
На пятом этапе на основе критерия минимума
затрат на развитие и функционирование ТЭК был
выбран оптимальный путь развития ТЭК, предусматривающий для всех перспективных моментов
времени увеличение добычи природного газа и
снижение добычи угля.
Заключение
Важными преимуществами метода комбинаторного моделирования являются представление
вариантов развития объектов и затем системы в
виде направленного графа, наглядность и компактность в представлении вариантов. Описание в виде
графа вариантов наглядно показывает их различия
и общие состояния или переходы.
К достоинствам следует отнести достигаемую
при этом полноту описания вариантов развития
системы. При традиционных способах сравнения
вариантов развития, основанных на многокритериальных методах, таких как метод анализа иерархии, исследователи обычно ограничиваются сопоставлением небольшого числа вариантов, выбор
которых обосновывается интуицией и накопленным опытом работы. Вместе с тем такой ограниченный выбор, даже если он сделан удачно, всегда
отражает некоторую субъективность. Это снижает
уровень доказательности получаемых результатов.
Полученные множества допустимых траекторий развития системы могут использоваться во
многих постановках задач прогнозирования, в том
числе с учетом фактора неопределенности. Среди
допустимых траекторий развития системы можно
согласно заданным критериям выбирать не только
оптимальные пути, но и все множество близлежащих траекторий.
Исследование выполнено при финансовой поддержке РФФИ, проект № 15-07-07412а.