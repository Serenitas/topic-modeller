В связи с увеличением объемов выдачи кредитов банками появились так называемые системы
кредитного скоринга – автоматизированные системы, основанные на применении математического аппарата и направленные на минимизацию
кредитных рисков при кредитовании клиентов. Основными задачами этих систем являются оценка
или прогноз кредитоспособности и платежеспособности клиентов банка на основе анкетных данных,
сведений, запрашиваемых из бюро кредитных историй, а также любой другой информации, которую может иметь банк . Однако, как показывает практика, рост задолженностей и невозврата
по кредитам, а также конкуренция на рынке кредитных услуг требуют совершенствования существующих методов и алгоритмов прогнозирования.
Предлагается система прогнозирования платежеспособности клиентов банка, состоящая из двух
подсистем: подсистемы прогнозирования кредитоспособности клиентов (анкетный скоринг) и подсистемы прогнозирования изменения платежеспособности заемщиков (поведенческий скоринг). Первая
подсистема реализует процедуру моделирования и
прогнозирования выдачи кредита с использованием агрегированных классификаторов (АК), полученных на основе методов машинного обучения
, вторая – процедуру моделирования и прогнозирования погашения кредита с использованием марковских цепей 1-го и 2-го порядков, а также методов машинного обучения. На рисунке 1 представлена структурная схема системы прогнозирования
платежеспособности клиентов банка.
АК на основе методов
машинного обучения
Для прогнозирования кредитоспособности клиентов применяются АК, представляющие собой
объединенные результаты следующих методов машинного обучения : нейронная сеть , наивный байесовский классификатор
, деревья
решений .
Для нахождения оптимальных АК используется
метод полного перебора всевозможных наборов
перечисленных выше базовых моделей. Таким образом, первый АК состоит из всех семи базовых
классификаторов, второй – из шести различных базовых классификаторов и т.д., последний АК состоит из двух различных базовых классификаторов.
Для формирования единого решения о кредитоспособности клиента на основе отдельных методов
классификации осуществляется объединение результатов одним из трех способов: по среднему
значению, по медиане, а также с помощью процедуры голосования.
Пусть P – вероятность кредитоспособности r-го клиента, найденная с помощью К-го базового классификатора, причем,
где l – количество клиентов, H – количество базовых классификаторов в наборе. Тогда получим следующие АК.
АК по среднему значению, где вероятность кредитоспособности r-го клиента, найденная с помощью АК по среднему значению.
АК по медиане: для начала следует ранжировать ряд, содержащий результаты базовых классификаторов в каждом наборе. В случае нечетного
числа базовых классификаторов вероятность кредитоспособности r-го клиента, полученная с помощью АК по медиане P, находится следующим образом.
В случае четного числа базовых классификаторов вероятность кредитоспособности r-го клиента
находится путем вычисления половины суммы результатов срединных базовых классификаторов.
Результат АК по голосованию представляет
собой среднее значение результатов базовых классификаторов, которые определили кредитоспособность клиента c вероятностью. В противном случае вероятность кредитоспособности
клиента равна нулю.
Совместное использование нескольких методов
классификации позволяет выделить следующие
преимущества: при рассмотрении каждого классификатора как процедуры поиска наилучшей гипотезы о распределении клиентов на классы кредитоспособности объединение результатов нескольких
классификаторов по среднему значению позволяет
усреднить ошибку каждой отдельной гипотезы;
при использовании нескольких методов классификации происходит расширение множества возможных гипотез и уменьшение влияния различных случайностей при определении гипотез; при использовании таких методов классификации, как НС и ДР,
есть вероятность «застрять» в локальном минимуме, а при использовании агрегирования результатов существует больше возможностей для нахождения глобального минимума.
Подсистема оценки
кредитоспособности клиентов
При принятии решения о выдаче кредита данная подсистема прогнозирует кредитоспособность
потенциального заемщика банка с помощью АК на
основе анкетных данных клиента (возраст, пол, семейное положение, сумма кредита, информация о
доходах и расходах и т.д.), а также визуализирует
полученные результаты и сохраняет их в файл
электронных таблиц Excel.
Поскольку в реальных статистических данных
приходится сталкиваться с рядом проблем , перед моделированием проводятся предварительный
анализ и обработка исходных данных по клиентам:
кодирование нечисловых данных, дискретизация
непрерывных данных методом биннинга .
Далее исходная выборка, представляющая собой анкетные данные по «старым» заемщикам, а
также класс кредитоспособности, делится на обучающую и тестовую части. Обучающая выборка
предназначена, как правило, для построения различных классификаторов, а тестовая используется
для прогнозирования и оценки качества классификаторов. При этом для получения более адекватных
и несмещенных оценок процедура разделения исходной выборки на обучающую и тестовую части
повторяется 10 раз в произвольном порядке. Затем
результаты прогнозирования, полученные на контрольных выборках, усредняются. Данная процедура называется 10-кратной перекрестной проверкой.
Критерием качества работы классификаторов
является дисперсия ошибки прогнозирования,
показывающая отклонение фактической вероятности принадлежности к классу кредитоспособности
r-го клиента P от прогнозируемой вероятности
принадлежности к классу кредитоспособности r-го
клиента P , которая стремится к минимальному
значению для заданного числа клиентов l.

Для каждой модели предлагается оптимальный
порог классификации клиентов на классы кредитоспособности, который находится с помощью решения задачи минимизации ошибок первого и второго рода .
Ошибка первого рода возникает, когда интересующее нас событие ошибочно не обнаружилось,
то есть это количество кредитоспособных клиентов, классифицированных как некредитоспособные . По сути ошибка первого рода характеризует коммерческий риск, связанный с отказом

кредитоспособным клиентам, где 
– вероятность перехода счета в состояние , если
предыдущими состояниями были в момент времени и в момент времени.
При этом в качестве состояний используется информация о просроченной задолженности
по кредитным счетам заемщиков.
Для оценки переходных вероятностей предложено использовать различные методы машинного
обучения, которые позволяют учитывать признаки,
предположительно, влияющие на платежеспособность заемщика (условия кредита и информацию о
самом заемщике). Например, зависимости между
оценками переходных вероятностей для марковской цепи 1-го и 2-го порядков, а также

– количество верно классифицированных кредитоспособных клиентов.
Ошибка второго рода возникает, когда при отсутствии события ошибочно выносится решение о
его присутствии, то есть это количество некредитоспособных клиентов, классифицированных как
кредитоспособные . Ошибка второго рода характеризует так называемый кредитный риск, где количество верно классифицированных некредитоспособных клиентов.
С помощью наилучшей модели и оптимального
порога классификации осуществляется прогноз
кредитоспособности «новых» клиентов. На рисунке 2 показан алгоритм работы подсистемы
оценки кредитоспособности клиентов.
Марковские цепи
и методы машинного обучения
Математические модели для описания динамики погашения по кредитам на основе марковских цепей 1-го и 2-го порядков, позволяющие учитывать прошлые состояния кредитной истории ,
имеют следующий вид:

где вероятность того, что кредитный счет
окажется в состоянии  в момент времени;
вероятность перехода счета из состояния в момент времени в состояние за один шаг; количество состояний;  вероятность того, что
счет окажется в состоянии в момент времени,
если предыдущими состояниями были;


признаками на основе дискриминантного анализа имеют следующий вид:

где априорные вероятности перехода счета из состояния в состояние и
из состояния в состояние соответственно; априорные вероятности отсутствия перехода счета из состояния в
состояние и из состояния в состояние соответственно; плотности распределения признаков , подчиняющиеся нормальному
закону распределения.
На основе ДР для каждого перехода и
строится свое ДР .
Поскольку зависимости между оценками переходных вероятностей, а также признаками, предположительно, влияющими на платежеспособность
заемщиков, предназначены для конкретного перехода из одного состояния кредитного счета в другое, предлагается выбор наилучшей модели для
каждого перехода, что повышает общую точность
прогнозирования по всем переходам.
Подсистема прогнозирования изменения
платежеспособности заемщиков
При погашении кредита заемщиком данная подсистема прогнозирует изменение платежеспособности заемщика с помощью марковских цепей и
методов машинного обучения на основе анкетных
данных клиента, кредитной истории, а также условий взятия кредита.
Перед моделированием также проводятся предварительный анализ и обработка исходных данных
по клиентам, в том числе восстановление пропущенных данных кредитной истории с использованием условного распределения по присутствующим параметрам .
Оценка качества прогнозирования моделей осуществляется на тестовой выборке, содержащей
данные по заемщикам в момент времени , которые не участвовали в процессе построения моделей. Основным критерием качества прогнозирования является доля верных прогнозов, усредненная по всем состояниям:
где
количество верных прогнозов для кредитных
счетов, находящихся в состоянии; общее количество прогнозов для кредитных счетов, находящихся в состоянии.
На рисунке 4 показан алгоритм работы подсистемы прогнозирования изменения платежеспособности заемщиков.
Численное исследование
Для проверки разработанной системы проведен
эксперимент, в котором в качестве исходных данных использовались данные по российским клиентам (данные предоставлены международной компанией по анализу и обработке данных АлгоМост
в 2015 г. и находятся в открытом доступе, а также банком Тинькофф в 2013 г. и
находятся в открытом доступе).
С помощью подсистемы прогнозирования кредитоспособности клиентов были построены базовые классификаторы и АК, а также найдены
наилучшие классификаторы для трех случаев: на
полном наборе исходных данных, при отборе информативных признаков, а также при отборе информативных признаков совместно с процедурой
дискретизации. В качестве примера на рисунке 5
представлены результаты построения моделей прогнозирования кредитоспособности клиентов при
отборе информативных признаков.
В таблице 1 показаны усредненные результаты
расчета дисперсии ошибок прогнозирования классификаторов для всех трех случаев.
Согласно результатам расчета дисперсии ошибок прогнозирования кредитоспособности российских заемщиков, а также результатам прогнозирования при нахождении оптимального порога
классификации, использование АК увеличивает
точность прогнозирования во всех трех случаях: на
полном наборе исходных данных, при отборе
информативных признаков, а также при отборе

информативных признаков совместно с процедурой дискретизации. При этом наилучший результат
достигается с использованием АК при отборе информативных признаков и представляет собой объединение результатов по голосованию ЛР и БДР


В случае оптимального порога классификации,
который равен 0,499, наилучший АК представляет
собой объединение результатов по голосованию
НС и БДР. При этом сумма ошибок I и II рода АК
по сравнению с отдельными базовыми классификаторами уменьшилась на 0,8–22,2 %.
Для прогнозирования кредитоспособности «новых» клиентов имеет смысл использовать один из
наилучших классификаторов, выбор которого зависит от политики кредитования банка.

С использованием подсистемы прогнозирования изменения платежеспособности заемщиков
были построены модели описания динамики погашения кредитов, а также найдены наилучшие модели для конкретного перехода из одного состояния кредитного счета в другое . В таблице 3
представлены результаты верных прогнозов для
каждой модели и марковской цепи 1-го и 2-го
порядков по всем возможным переходам из отдельного состояния в другие состояния, средний результат  по всем состояниям, а также максимальные значения  для каждого состояния,
выраженные в процентах.
Результаты исследования показали, что нет единой модели, наилучшим образом прогнозирующей
все переходы из состояния в другие состояния.
Для прогнозирования изменения платежеспособности заемщиков в следующем периоде оптимальным вариантом является выбор наилучшей марковской цепи и модели для каждого перехода, что в
среднем улучшает результаты отдельных моделей
от 7,6 до 63 % .
Таким образом, как показывает проведенное
численное исследование, предложенные методы и
алгоритмы улучшают качество прогнозирования
кредитоспособности и изменения платежеспособности заемщиков. Следовательно, разработанная
система может быть использована для поддержки
принятия решений в процессе кредитования клиентов банками, начиная с процесса выдачи кредита и
до последующего погашения по текущим кредитным платежам.