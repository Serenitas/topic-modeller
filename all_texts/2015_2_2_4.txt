Выявление периодичности и прогнозирование временных рядов в экономике



1. Введение 

Анализ и прогнозирование временных рядов, описывающих социально-экономические процессы, является мощным и хорошо развитым направлением экономико-математического анализа данных [1–9]. Вообще говоря, основной задачей экономико-математического прогнозирования является построение такой вероятностно-статистической модели временного ряда, чтобы последующие наблюдения подтверждали спрогнозированные значения с заданной точностью. В такой постановке эта задача может вообще не иметь решения, поскольку экономические процессы обычно не являются детерминированными. В ослабленной формулировке задачей прогнозирования можно считать построение модели, обеспечивающей прогноз на определенный временной интервал при условии сохранения действующих в исследуемой экономической системе тенденций и внутренних связей с указанием достоверности прогноза и величины его возможной ошибки. 

При построении экономико-математических моделей обычно выделяют трендовую, сезонную, циклическую и случайную составляющие временного ряда (см., например, [10–15]). Трендовая и циклическая компоненты призваны описывать соответственно основную непериодическую и основную периодическую тенденции в динамике рассматриваемого временного ряда. Это может иметь не только экономическое, но и управленческое значение. Традиционно под трендовой компонентой понимают непериодическую (полиномиальную, логарифмическую, показательную или др.) функцию, связывающую исследуемую величину с переменной времени, а под циклической компонентой — соответствующую синусоиду или линейную комбинацию синусоид. Сезонная компонента, по большому счету, выделяется из семейства циклических процессов в отдельный блок исключительно в силу экономической природы исследуемых процессов и явлений, характеризуется заданным периодом времени (кварталом) и наибольшую роль играет при прогнозировании результатов финансовой отчетности. В том случае, если рассматривается выборка данных, не имеющая заведомо жесткой привязки к сезону, выделение сезонной компоненты может быть нецелесообразным. С другой стороны, можно обобщить понятия сезонной и циклической компонент, придав одной из них смысл высокочастотных, а другой — низкочастотных периодических колебаний в динамике исследуемых социально-экономических процессов. Наконец, случайная компонента — то, что остается необъясненным после исключения трендовой, сезонной и периодической компонент, и характеризуется каким-либо законом распределения с нулевым математическим ожиданием. Вообще говоря, определить заранее, какие компоненты доминируют в том или ином временном ряду невозможно [12, 14], если неизвестны доминирующие факторы и их временное развитие. Безусловно, существует множество временных рядов, в которых трендовая составляющая является четко выраженной, а остальные оказываются сравнимыми со случайной компонентой. Однако не меньше существует и временных рядов, в которых четко выраженной оказывается циклическая компонента с тем или иным периодом (или набором периодов), а трендовая компонента несущественно отличается от случайной. И, наконец, наиболее «неприятным» с точки зрения математического анализа случаем является сопоставимый вклад трендовой и циклической компонент в динамику исследуемого временного ряда. Возникают две стратегии построения модели временного ряда: сначала выделить трендовую составляющую, а затем циклическую [17, 18], или наоборот, сначала выделить периодическую компоненту, а затем — трендовую. 

Более того, компоненты модели могут быть скомбинированы в аддитивный или мультипликативный (или любую комбинацию, по крайней мере, из этих вариантов) временной ряд [4]. Поскольку природа социально-экономических процессов зачастую не поддается детерминистическому описанию, далеко не во всех случаях можно предположить, каков истинный характер связей между компонентами соответствующей модели. То есть, для увеличения достоверности, при построении прогноза потребуется рассмотреть, по крайней мере, несколько наиболее часто встречающихся и простых в описании и интерпретации вариантов модели. Сначала обсудим традиционные трендовые функции [10]. Для решения задачи прогнозирования в узком смысле наиболее пригодными являются простые тренды с наименьшим количеством управляющих параметров, так как для них проще всего производить расчеты и интерпретировать полученные результаты (что отражено, например, в MS Excel). Недостатком таких моделей является заведомая потеря адекватности модели по мере удаления от области, в которой представлены экспериментальные данные. Более того, сама логика социально-экономических процессов предполагает конечное число значений исследуемой величины, из чего следует обязательная корректировка простых трендов по мере поступления новых экспериментальных данных, т. е. «автоматически» требуется переход к адаптивным моделям прогнозирования той или иной степени сложности. По сути дела традиционное выделение тренда — это и есть адаптивно-статистическое прогнозирование с окном сглаживания, совпадающим со всем имеющимся набором экспериментальных данных. 

С точки зрения социально-экономических процессов наиболее адекватными были бы ограниченные сверху и снизу тренды двух типов: определенные на конечном множестве значений аргумента для описания процессов с четко заданным началом и концом, и определенные на всей числовой прямой для описания теоретически бесконечных во времени процессов. Эти тренды суть радикал-содержащие выражения вида обратные тригонометрические функции (arcсos(t), arctg(t)), функции вида и им подобные. При определенных значениях управляющих параметров на ограниченном наборе значений независимой переменной все эти выражения с той или иной степенью адекватности описываются классическими трендами за счет возможности разложения этих выражений в ряд Тейлора, при этом являясь более обоснованными с точки зрения логики социально-экономических процессов. Заметим также, что каждому из этих трендов можно однозначно сопоставить некоторое распределение, особенно в том случае, если наблюдения ведутся более или менее через одинаковые промежутки времени. Однако вопрос адекватного выделения трендовой составляющей социально-экономических рядов в этой работе мы рассматривать не будем. 

Рассмотрим циклические составляющие по теории Эллиотта [4]. Во-первых, синусоиды с большими периодами вычислительно неотличимы от полиномов, но гораздо более логичны с точки зрения экономики. Во-вторых, можно провести спектральный анализ экспериментальных данных, разложив их в ряд Фурье [20]. Однако экспериментальные данные не являются непрерывной функцией, а разложение в ряд требует, чтобы функция на заданном интервале была хотя бы кусочно-непрерывной. 

Значит, если идти по этому пути, надо как-то «сшивать» экспериментальные наблюдения — прямыми, параболами, экспонентами, логарифмами и т. д. На этом этапе уже будет внесено большое количество вычислительных ошибок. Далее при попытке разложить в ряд с помощью того или иного программного средства «выяснится», что основная масса программных пакетов реализует FFT (Fast Fourier Transformations) [21], а значит на непрерывной функции нужно будет выделить кратное степени 2 количество точек, а сделать это можно бесконечным количеством способов — добавятся еще ошибки. 

При построении экономико-статистической модели наибольший интерес представляет низкочастотная область спектра. Фактически — требуется оценить параметры разложения в линейную комбинацию не очень большого количества синусоид (и косинусоид) с кратными частотами (при этом каждой значимой синусоиде желательно найти экономическое обоснование). 

Определение основного периода колебаний на данном этапе исследования становится основной задачей. При частотном анализе с помощью FFT мы задаем этот период неявно выборкой из значений, но он вовсе не обязан быть именно кратным 

функции не дает никаких указаний на то, какой период выбрать. а описанный выше пересчет через введение промежуточной непрерывной 

Согласно определениям [22–24], функция называется периодической, если существует такое число (период), что на всей области определения функции выполняется равенство 

 С формальной точки зрения для поиска периода T непрерывной функции достаточно последовательно перебрать все значения T, проверяя тождество-определение. Однако, во-первых, это невозможно сделать, так как период может быть достаточно большим, а представленный набор экспериментальных данных — недостаточно большим, а во-вторых, экспериментальные данные представлены набором значений, а не непрерывной функцией, т. е. требуется аппроксимация, описанная выше, со всеми вытекающими негативными последствиями. Более того, в случае с аппроксимацией точного равенства может и не получиться, а значит, возникает дополнительная вероятность ошибок с определением периода. При реальной оценке периода по экспериментальным данным можно построить гистограмму зависимости суммы квадратов отклонений от значения параметра m, кодирующего количество интервалов времени между соседними измерениями. Здесь 

 — уровни исследуемого ряда. Если периодическая зависимость присутствует, то локальные минимумы соответствующей гистограммы будут указывать на возможные значения периодов. Однако достоверность в определении периода указанным способом требуется подтверждать еще каким-либо методом. 

Предлагаем следующую идею: если функция периодическая (или содержит существенную периодическую компоненту), то распределение наблюдений по одному периоду должно совпадать с распределением по всем наблюдаемым периодам. Можно представить себе такие данные, для которых это не будет соответствовать действительности, поэтому обсуждаемое условие является необходимым, но не достаточным. (То есть, после формирования гипотезы о минимальном периоде необходимо проверять ее стандартными эконометрическими методами на всей доступной совокупности экспериментальных данных). Таким образом, для практической реализации предлагаемого метода необходимо построить эмпирическую функцию распределения, характеризующую весь набор экспериментальных данных, эмпирические функции распределения, характеризующие отдельные части выборки, и сравнить полученные функции распределения между собой (например, используя соответствующие модификации критериев Пирсона и Колмогорова-Смирнова). Часть выборки, для которой распределение будет соответствовать порогу статистического разрешения относительно распределения, построенного по всей выборке, и будет задавать наиболее вероятное значение периода. 

2. Оценивание периода 

Рассмотрим пример формирования гипотезы о наиболее вероятном значении периода. В графическом виде на рис. 1 представлены экспериментальные данные, о природе которых мы заранее почти ничего сообщать не будем, кроме того, что это реальные данные о динамике некоторого социально-экономического процесса. Вообще говоря, визуальный анализ позволяет предположить наличие периодичности в рассматриваемом временном ряду, однако, во-первых, видно, что амплитуда колебаний меняется со временем, что может привести к искажению значения периода, во-вторых, видно, что разброс наблюдаемых значений маскирует этот период, а в-третьих видно, что задавать кусочно-непрерывную функцию (для последующего Фурье-анализа) по представленным экспериментальным данным весьма неудобно. 

Сначала оценим период следующим образом: построим гистограмму зависимости суммы квадратов отклонений (1) от значения параметра m, кодирующего количество интервалов времени между соседними измерениями рис. 2. 

Рисунок 2. Зависимость суммы квадратов отклонений (1) от значения параметра m, кодирующего количество интервалов времени между соседними измерениями (здесь l, m и n выбраны так, чтобы количество участвующих в анализе точек было одинаковым) 

Из рис. 2 видно, что первый наблюдающийся локальный минимум находится в диапазоне значений от 140 до 150, т. е. наиболее вероятный период должен находиться также в этом диапазоне. Более того, видно, что локальные максимумы наблюдаются при значениях n близких к 75 и 220, что косвенно подтверждает наличие периода в указанном диапазоне значений (так как локальный максимум должен соответствовать нечетным полуцелым значениям периода). 
Осуществим проверку этой гипотезы методом построения и сравнения эмпирических распределений. Если разделить выборку пополам, построить гистограмму для распределения целиком и для каждой половины (рис. 3), а потом с помощью критерия Пирсона сравнить результат, то гипотеза об идентичности обоих распределений базовому должна быть принята с вероятностью не менее чем 95%. 

Если разделить выборку на четыре части (гистограмма рис. 4), то гипотеза об идентичности всех четырех распределений базовому может быть принята уже только с вероятностью 66% (рис. 5). Далее, разделив выборку на восемь частей, убедимся, что блоки С, F, H характеризуются распределениями, существенно отличающимися от базового, т. е. такое разбиение по всей видимости слишком «частое» (см. рис. 6 и рис. 7). 

Поскольку разбиение на четыре блока не обладало вышеуказанным недостатком, логично предположить, что возможно разбиение исходной выборки на шесть частей («середина» между четырьмя и восемью) будет обладать этим свойством. Видно, что при таком разбиении в представленной выборке могло бы «уместиться» чуть более пяти периодов некоторой периодической функции. Однако проверка разбиением на шесть и на пять компонент (рис. 8, 9 и 10, 11) не позволяет подтвердить это предположение, так как последние блоки данных (рис. 9 и 11) характеризуются недостаточно большой вероятностью совпадения парциального и базового распределений. Таким образом, полагая 50%-м порогом доверия, можно предполагать, что в представленной выборке от четырех до пяти периодов. Причем ближе к концу выборки, по всей видимости, наблюдается изменение трендовой составляющей. Здесь надо отметить, что визуальный анализ рассматриваемых данных позволяет сделать эти же предположения без привлечения какого-либо математического анализа, однако задачей данной работы является построение части алгоритма автоматизации обработки социально-экономического временного ряда БЕЗ участия эксперта. Теперь проверим гипотезу с помощью критерия Колмогорова-Смирнова. Для этого построим эмпирические функции распределения для всех рассмотренных разбиений выборки и осуществим сравнение d-статистик с критическим, рассчитанным для распределения по всей выборке. Результаты сравнения представлены в таблице. Примечание к табл. В первой строке — количество частей, на которые разбивается исходная выборка, а ниже представлены значения d-статистик (сравнения эмпирических распределений для полученных частей с эмпирическим распределением для всей выборки в целом). Знаком «–» выделены блоки данных, распределение в которых значимо отличается от исходного согласно критерию Колмогорова-Смирнова. 

Таким образом, предположения, выдвинутые на предыдущем этапе анализа, подтверждаются: наиболее вероятным представляется наблюдение четырех или пяти периодов квазипериодической функции. 

3. Формирование регрессионной модели 

На следующем этапе исследования необходимо осуществить разложение в ряд Фурье, осуществить высокочастотную фильтрацию и смоделировать динамику исследуемого процесса. Проведем разложение в ряд Фурье  исследуемой функции формально. Всего наблюдалось 734 точки. Максимальным значением периода является 183.5 точки (четыре периода); условно наиболее вероятным — 146.8 (пять периодов); минимальным — 122.3 (шесть периодов). Подготовимся к разложению в ряд Фурье с периодом в 184 точки. Для того чтобы иметь возможность применять FFT, необходимо, чтобы количество точек было равно 

 Если задавать функцию внутри одного периода, то от первоначального объема должно остаться примерно 70% точек, либо должно появиться на 40% точек больше, чем есть. Разумнее в качестве периода выбрать 512 точек и отбросить разницу в 40 точек (184·4 = 552), так как при этом будет потеряно всего 8% точек. В результате такого разложения доминируют третья, четвертая и седьмая гармоники, т. е. периоды 512/3 = 171, 512/4 = 128 и 512/7 = 73 с весами 1.64; 1.29 и 0.89 соответственно. Теперь осуществим примерное разложение в ряд Фурье по наиболее вероятному периоду. Для этого подберем ближайшую кратную ему степень двойки: (147 – 128)/128 = 15%. Доминируют первая, вторая и четвертая гармоники, т. е. периоды 128, 64 и 32 с весами 1.90; 1.23 и 0.85 соответственно. Для минимального периода это же разложение является наиболее вероятным. Таким образом, предварительные оценки показывают, что для описания динамики циклической компоненты рассматриваемого временного ряда в первом приближении достаточно трех гармоник для периода из диапазона от 122 до 184 с наиболее вероятными значениями периодов гармоник в этом интервале. В программе Microcal Origin есть возможность аппроксимировать экспериментальные данные произвольной нелинейной кривой с параметрами за счет подбора этих параметров методом Левенберга-Маркуарта.  Возьмем с избытком сразу десять гармоник для периода в 147 точек и аппроксимируем экспериментальные данные. Результат показан на рис. 12. 

Рисунок 12. Разложение Фурье до десятой гармоники (сплошная кривая). Здесь, как и на рис. 1, а также на рис. 13–15 по оси Х — номер измерения, по оси Y — значения баллов наблюдавшейся величины Из рисунка видно, что все характерные особенности отражены, однако не хватает тренда, который бы увеличил все амплитуды в начале выборки и уменьшил бы их в конце. Если общим множителем к получившейся функции выбрать, например, параболу, то получится кривая, показанная на рис. 13 «синим цветом». Ясно, что прогностическая сила при использовании полиномиального тренда невелика, однако качество аппроксимации экспериментальных данных сразу становится приемлемым с точки зрения коэффициента детерминации. Заметим, что коэффициент детерминации параболического тренда без периодической составляющий не превышал значения 0.19, т. е. был категорически не приемлем, и не мог вызывать особого доверия как компонент модели. В то же время вклад циклической компоненты параболического тренда характеризовался коэффициентом детерминации на уровне 0.62, что также не достаточно, но позволило объяснить гораздо более существенную долю дисперсии экспериментальных данных. То есть «правильной» стратегией в данном случае оказалось именно первичное выделение циклической компоненты, и лишь затем — формирование непериодической трендовой составляющей. Видно, что качество прогноза «вправо» вызывает большие сомнения, так как отрицательных значений баллов в представленной выборке не наблюдалось ни разу, а «влево» — качество прогноза можно признать удовлетворительным. Чтобы снять проблему с отрицательными значениями надо вспомнить самое начало этой статьи: для социально-экономических рядов тренды не должны быть полиномиальными. Используя ту же мультипликативную модель, но заменяя параболу на квадрат косинуса с параметрами «амплитуда», «период» и «начальная фаза», получим синюю кривую (и соответствующий прогноз на один период «влево» и «вправо» от экспериментальных данных) рис. 15. Рисунок 15. Экстраполяция полученной кривой «влево» и «вправо» с использованием в качестве модулирующей кривой в мультипликативной модели функции квадрат косинуса 

На этот раз отрицательных значений не прогнозируется (в силу естественных ограничений на область значений выбранной трендовой функции), а модельный коэффициент детерминации достигает значения 0.91, превышая традиционно применяемый в эконометрическом анализе пороговый уровень 0.8. 

4. Заключение 

В заключение отметим, что рассмотренные данные — выраженные в баллах значения среднего уровня загруженности дорожной сети в городе Москве (первичные данные заимствованы с сервиса «пробки» службы yandex) за несколько дней — со вторника по субботу. Прогноз вправо — воскресенье, а влево — понедельник. Качество прогноза можно признать удовлетворительным: в понедельник пробки не всегда достигают своего максимума, а в воскресенье трафик заметно снижается. Следует также отметить, что компьютер «ничего не знал» про период неделя, однако подобрал период тренда правильно и достаточно качественно предсказал динамику пробок на один день на основании информации всего только о пяти днях. 

Улучшить качество прогноза можно: анализируя большее количество данных; выбрав более качественный тренд; используя априорную информацию о природе исследуемых данных.

