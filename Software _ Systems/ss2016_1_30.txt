Анализ и обработка данных для прогнозирования состояния больных



С развитием информационных технологий большое внимание уделяется автоматизированным способам анализа и обработки информации. Создание программного комплекса для автоматизированного учета и прогнозирования состояний больных описывалось в [1]. Одним из важных модулей разработанного программного комплекса является модуль анализа и обработки данных о состоянии здоровья пациента на основе результатов анализов. В данной статье представлены два связанных способа обработки данных: многофакторный анализ данных с использованием метода главных компонент (МГК) . С помощью этих математических методов обрабатываются данные анализов пациента и на их основе прогнозируется правильность лечения с использованием выбранного целевого параметра во времени. На основе значений целевого параметра лечащий врач принимает решения о дальнейших назначениях и путях лечения пациента.

В ходе использования и развития программного комплекса выявлено, что входящими данными для анализа и обработки являются 16 параметров (данные анализов пациентов). Результат обработки информации – предсказанное значение целевого параметра, изменяемое во времени.

Методы анализа и обработки данных

Многофакторный анализ данных с использованием МГК.

Дисперсии компонент будут равны собственным числам матрицы ковариаций.

Геометрически нахождение главных компонент сводится к переходу к новой ортогональной системе координат. Первую координатную ось определяют так, чтобы соответствующая ей линейная комбинация извлекла возможно большую дисперсию. Вторую ось строят ортогонально первой таким образом, чтобы извлечь наибольшую часть от оставшейся дисперсии. Все оставшиеся компоненты определяют аналогично. Таким образом, все компоненты ортогональны друг другу.

В ряде задач МГК дает возможность значительно снизить размерность задачи за счет того, что линейные комбинации (компоненты), имеющие маленькие дисперсии, отбрасываются, а анализируются лишь линейные комбинации с большими дисперсиями [2], обычно не менее 80 % от общей дисперсии.

Данные, полученные в результате экспериментальных исследований, были обработаны с использованием МГК .

На рисунке 1 представлена диаграмма, отражающая статистические параметры обрабатываемых данных. Из диаграммы видно, что данные сильно различаются по шкалам и требуется их дополнительная обработка.

Перед применением МГК данные предварительно центрировались и шкалировались относительно стандартного отклонения. Нахождение компонент проводили с использованием самостоятельно разработанного программного пакета. Статистические параметры данных после их обработки показаны на рисунке 2.

Для оценки того, сколько компонент необходимо для описания данных с заданной точностью (не менее 90 % дисперсии), а сколько можно отбросить и не учитывать в дальнейшем, была построена диаграмма Парето, приведенная на рисунке 3. Из диаграммы видно, что для описания 90 % дисперсии достаточно учесть первые 10 компонент. Рассмотрим их подробнее.

Для визуального представления расположения данных в проекционном пространстве были построены графики счетов для первых десяти компонент (примеры для первых четырех компонент приведены на рисунке 4).

Графики счетов, а также значения коэффициентов перехода к системе координат на основе главных компонент позволяют наглядно представить, как распределены данные, что особенно важно при формировании обучающей и тестовой выборок с помощью различных математических моделей.

На графике счетов для первых двух компонент (компоненты 1 и 2 на рис. 4) отсутствует явное разделение данных на группы. На графике счетов для вторых двух компонент (компоненты 3 и 4, рис. 4) данные образуют две большие группы, причем данные в них распределены практически равномерно.

Из приведенного анализа данных следует отметить, что, формируя обучающие и тестовые выборки, при разработке математического описания необходимо учитывать не только факторы, которые варьировались в ходе проведения эксперимента, но и ряд характеристик полученных образцов. Обучающая и тестовая выборки должны содержать данные, отличающиеся по этим показателям.

Наглядное представление о связи переменных между собой и их взаимном влиянии дают графики нагрузок – векторные графики в виде двухмерных или трехмерных проекций, приведенные на рисунках 5 и 6. Данные графики читаются следующим образом: чем ближе векторы расположены относительно друг друга, тем большая положительная корреляция имеется между данными; если векторы направлены в диаметрально противоположные стороны, между данными существует сильная обратная корреляция. 

Из анализа графиков нагрузок можно заметить следующее.

Таким образом, использованный метод многофакторного анализа (МГК) позволил сократить размерность задачи, выявил требования к формированию обучающей и тестовой выборок для построения математической модели на основе нейронной сети, а также позволил определить ключевые факторы, которые должны быть использованы в качестве входных параметров в нейросетевой модели.

Использование нейронных сетей. Методы искусственного интеллекта – это современное направление развития методов математического моделирования свойств объектов, динамических процессов и поведения систем. Одним из широко применяемых методов являются нейронные сети [7, 8].

Многообразие существующих архитектур нейронных сетей позволяет использовать методы нейроинформатики для решения практически любых классов задач. Чаще всего среди этих задач фигурируют аппроксимация данных, прогнозирование временных рядов, математическое моделирование свойств объектов, распознавание образов, классификация, кластеризация данных, управление.

Искусственные нейронные сети – достаточно сложный математический аппарат. Для их использования зачастую требуются большие объемы исходной информации и значительные вычислительные ресурсы. Поэтому для решения достаточно простых задач целесообразно использовать другие известные и широко применяемые методы. Определим основные понятия нейронных сетей. Искусственный нейрон – это элементарная структурная единица искусственной нейронной сети, выполняющая функции по обработке входных сигналов, поступающих с других нейронов, и представлению результата в форме выходного значения.

Для решения задачи прогнозирования изменения значений целевого параметра во времени были спроектированы и протестированы нейронные сети. Структура нейронной сети, наиболее подходящей для решения задачи , представлена на рисунке 7.

Предложенная нейронная сеть была обучена на обучающих выборках (из 200 экспериментов) и проверена с помощью тестовых выборок (из 50 экспериментов). Выходным показателем для нейронной сети был выбранный целевой параметр. На рисунке 8 показано сравнение расчетных и экспериментальных данных во времени.

Ошибка предсказания значения целевого параметра не превышала 8 %. Это дает возможность использовать обученную нейронную сеть для предсказания значений целевого параметра во времени при различных значениях показателей.

Расчет по нейронным сетям проводился с помощью созданного ПО, скриншоты которого представлены на рисунке 9.

ПО было реализовано на языке программирования C#. Для его разработки и отладки использовалась среда разработки Visual Studio. Разработанное ПО может быть исполнено на обычном рабочем компьютере и позволяет обработать массив данных до 500 экспериментов за 10 минут.

В заключение отметим, что в статье была проиллюстрирована возможность применения двух современных математических подходов к анализу и обработке данных: многофакторного анализа данных с использованием МГК и нейронных сетей. Данные методы хорошо показали себя при обработке большого массива разнородных данных и выявлении корреляций между данными. Для применения этих методов было разработано ПО, которое позволило обработать исходные данные (анализы пациентов) и на их основе предсказать значение целевого показателя.

