Редактирование и внесение информации в XML-документы автоматизированных информационных систем



В условиях современного информационного общества широкое развитие получили многочисленные системы обработки экономической информации учетного и планирующего характера. Кроме того, появились возможности оперативной обработки и визуального представления информации, что позволяет создавать ситуационные центры (СЦ) для поддержки принятия экспертных решений как в online-, так и в offline-режиме. Такая потребность может возникать при использовании программных продуктов в ограниченном функционале, например, при анализе инвестиционных проектов внешним пользователем, а также в условиях СЦ оперативно-экспертной поддержки принятия решений. Одной из важных задач при функционировании СЦ является автоматизированное внесение информации в программные продукты, для которых имеется XML-код . Это может быть обусловлено многими факторами, например, аппаратными требованиями персонального компьютера пользователя, высокой стоимостью полного ПО, необходимостью или возможностью использования только отдельно взятых модулей системы и т.д. Таким образом, возникает необходимость частичного доступа к возможностям некоторой автоматизированной информационной системы (АИС)  без ее непосредственной установки на персональный компьютер.

В статье предложены алгоритм, а также техническая реализация процесса удаленного (online) внесения изменений пользователем через определенный требованиями ПО шаблон входной информации, который может располагаться в Excelдокументе, web-форме облачного data-центра или в другом электронном источнике.

Основная идея и концепция 

Рассмотрим решение сформулированной задачи на примере программной системы «Карма». Система представляет собой автоматизированный комплекс для внесения, обработки и анализа входной информации экономического содержания. Данный комплекс имеет возможности создания и корректировки математических моделей в форме многопараметрических задач линейного программирования, контроля корректности внесения информации, создания собственной конфигурации проекта (разделов, блоков переменных и т.п.), а также графический анализатор, визуализирующий многопараметрические зависимости и Парето-множества. Это позволяет использовать данную систему специалисту-математику, экономисту-аналитику и бизнесмену . Однако для пользователя эта система представляется в виде XML-файла, непосредственное изменение которого ему недоступно, и не позволяет автоматизированно вносить массивы входной информации для использования функциональных возможностей системы.

Рассмотрим следующий вариант получения входной информации от пользователя в указанный пакет. Информация об экономических характеристиках некоторого инвестиционного проекта заносится в файл строго фиксированного формата (Word, Excel или др.) и передается в пакет «Карма» путем ее преобразования через разработанный авторами специальный программный модуль – Instrument for Data Acquisition (IDA-модуль), работа которого будет описана далее. На рисунке представлена схема преобразования информации проектов социально-экономических систем от стадии ее внесения в исходный XML-файл до выдачи результатов расчетов.

Рассмотрим подробно каждый из этапов.

 Для работы с IDA пользователю необходимо внести в соответствующие поля стандартной формы IDA входную информацию о характеристиках инвестиционного, производственного или финансового проекта.

 IDA-модуль автоматически вносит отредактированные значения в XML-файл, осуществляя подстановку введенных параметров в соответствующую группу показателей, необходимых для работы системы. При этом последовательность внесения информации через IDA соответствует последовательности ее обработки в XML-файле. То есть по завершении процесса внесения данных в IDA вся информация попадает в облачное хранилище, откуда с помощью административной панели IDA вносится в необходимый XML-файл для дальнейших расчетов оператором.

 Результаты многопараметрического анализа проекта предоставляются заказчику в виде отчета.

Техническая реализация 

В основе загрузки параметров для расчета моделей в  лежит хранение параметров в виде XML-файлов. Конфигурационный файл содержит экономические параметры, разделенные на соответствующие группы по принадлежности (например, «Налоги», «ФОТ и другие затраты», «ИП внешние характеристики» и т.д.). Он защищен от редактирования с помощью внутренних инструментов. При занесении информации следует учитывать повышенный риск возникновения ошибок некорректного ввода значений в XML-файл.

В процессе изучения конфигурационного файла первоначально необходимо обратить внимание на его структуру, включающую элементы разметки (markup), содержимое файла, а также XML-тэги, предназначенные для определения элементов документа, их атрибутов и других конструкций языка.

XML-файл имеет древовидную структуру. В документе всегда есть корневой элемент. У элемента дерева всегда существуют потомки и предки, кроме корневого элемента, у которого предков нет, и тупиковых элементов (листьев дерева), у которых нет потомков .

В процессе изучения вопроса были сформулированы следующие требования к формированию XML-файла:  каждый открывающий XML-тэг определяет некоторую область данных в документе и должен иметь своего закрывающего «напарника»;  в XML-файле учитывается регистр символов;  все значения атрибутов, используемых в определении тэгов, должны быть заключены в кавычки;  вложенность тэгов в XML-файле строго контролируется, поэтому необходимо следить за очередностью открывающих и закрывающих тэгов;  вся информация, располагающаяся между начальным и конечными тэгами, рассматривается в XML-файле как данные, и поэтому учитываются все символы форматирования (пробелы, переводы строк, табуляции не игнорируются, как в HTML).

После соблюдения этих правил документ принято считать формально правильным и все анализаторы, предназначенные для разбора XML-документов, смогут работать корректно. Однако очень важно отметить, что, помимо проверки на формальное соответствие грамматике языка, в XML-файле могут присутствовать средства контроля над его содержанием, за соблюдением правил, определяющих необходимые соотношения между элементами и формирующих структуру XML-файла. Чтобы обеспечить проверку корректности XML-файла, необходимо использовать анализаторы, производящие подобную проверку. На сегодняшний день практикуются два способа контроля соответствия XML-файла вышеописанным правилам: DTD-определения (DocumentTypeDefinition) и схемы данных (SemanticSchema) .

Представим фрагмент конфигурационного файла информационной системы «Карма» после завершения вышеописанных действий По завершении анализа конфигурационного файла необходимо выбрать подходящую программную реализацию для внесения экономических параметров в конфигурационный файл без взаимодействия с «Кармой».

Наиболее подходящим программным методом решения данной проблемы явился язык запросов к элементам XML-файла – XPath (XML PathLanguage). Он был разработан для организации доступа к частям документа формата XML в файлах трансформации XSLT (eXtensibleStylesheetLanguageTransformations) и является стандартом консорциума W3C .

На каждом шаге отбираются элементы дерева XML-файла, соответствующие последовательности обращения к параметрам модели «Карма». В результате формируется множество элементов дерева, отвечающих структуре входной информации , которые могут использоваться для проведения расчетов в нем. Представим фрагмент программного кода «обращение к элементу дерева в XML-файле». 

Заключение 

В результате проведенной работы удалось реализовать программный модуль для внесения параметров в конфигурационный файл автоматизированной информационной системы финансово-аналитического содержания . В перспективе данное решение предоставляет возможность конечному пользователю взаимодействовать с системой «Карма» без непосредственной установки ее на персональном компьютере, обеспечивая при этом доступ к функциональным возможностям автоматизированной информационной системы для проведения инвестиционного, производственного и финансового анализа проектов развития социально-экономических систем.

Отметим, что предложенный комплекс, состоящий из финансово-аналитической системы и пакета автоматического внесения информации в нее, ориентирован на использование в СЦ социальноэкономического анализа, является удобным инструментом оперативной поддержки экспертных решений в случае как очного, так и удаленного присутствия экспертов. Данный комплекс прошел тестирование в СЦ регионального социально-экономического развития Кемеровского филиала Российского экономического университета имени Г.В. Плеханова.

