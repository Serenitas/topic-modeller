Интерпретатор дыхательных шумов с адаптацией к средствам регистрации сигналов



Традиционно автоматизированная интерпретация результатов исследования органов дыхания опирается на методы, определяющие структурные изменения в объекте (рентгенографию, томографию). Они позволяют обоснованно формулировать диагностическое заключение, но являются затратными (томография) и требуют повышенных мер безопасности при эксплуатации аппаратуры (рентгенология).

Учитывая, что заболевания органов дыхания могут развиваться довольно быстро и носят инфекционный характер, особое значение приобретают инструментальные средства для проведения массовых обследований. Очевидно, что улучшение их технических характеристик будет способствовать повышению точности постановки диагноза на ранних стадиях заболеваний.

Наиболее распространенными среди скрининговых методик являются методики аускультации. В последние годы в этой области наблюдается значительный прогресс, обусловленный появлением электронных стетоскопов. Эти устройства не только позволяют повысить точность оценки акустических признаков, но и обеспечивают регистрацию дыхательных шумов (ДШ), что способствует переходу к методикам доказательной медицины. Электронные стетоскопы дают возможность применять компьютерные технологии и для решения задач, связанных с автоматическим анализом слабых акустических сигналов, регистрируемых на корпусе человека.

Программные средства, применяемые в электронных стетоскопах

На данный момент устройства регистрации звуков дыхания технически достаточно совершенны. Среди наиболее значимых серийных линеек электронных стетоскопов можно выделить 3M Littmann, Cardionics e-scope, Contec cms-ve, Adc adscope, Welch Allyn elite, Think Labs . Они обладают близкими функциональными характеристиками: имеют интерфейсы для передачи данных на другой регистратор или на устройство обработки (ПК, планшет и т.д.) и память для сохранения нескольких записей.

Главные различия моделей связаны с характеристиками первичных преобразователей акустического сигнала в электрический. Звуковые сенсоры (датчики), применяемые в стетоскопах различных производителей, могут быть разных типов (микрофонного, конденсаторного, пьезо-электрического), что приводит к значительным отличиям в их частотных характеристиках .

Практически все представленные на рынке электронные стетоскопы поставляются с собственным ПО, которое определяет функции обработки и интерпретации зарегистрированных акустических сигналов.

1. Программа 3M Littmann StetshAsist поставляется в комплекте с цифровыми стетоскопами Littmann. Основное ее назначение – визуализация результатов исследований, захват и сохранениезвуковых записей со стетоскопа, преобразование их в различные аудиоформаты (wav, mpeg layer 3). Программа выполняет расчет и визуализацию спектрограмм легочных и сердечных шумов, обеспечивает возможность сохранения результатов в специальном формате, включающем, помимо самих звуковых записей, метаинформацию об условиях проведения исследования, локализации точек регистрации и т.п.

2. Программа 3M Littmann Scope-to-Scope TeleAuscultation Software ориентирована на задачи телемедицины, позволяет передавать от стетоскопа цифровой зашифрованный сигнал через сети передачи данных к другому стетоскопу либо к компьютеру.

3. Программа Welch Allyn Elite Analyzer по своему функционалу аналогична 3M Littmann StetshAsist. Ее отличительная особенность – возможность отображения комбинации фонокардиограммы с синхронизированным сигналом электрокардиографа.

4. Программа Think Labs Phonocardiography Software основана на свободно распространяемом ПО Audacity. Программное средство обладает наиболее богатым набором возможностей среди прочего рассмотренного ПО и обеспечивает следующее: запись и воспроизведение звуков, импорт звуковых записей из различных форматов; визуализацию записей в виде спектрограммы или амплитудных изменений звука, возможность усиления отдельных участков записей, контроль скорости воспроизведения звука, возможность применения различных фильтров; возможность группировки записей пациентов; возможность добавления метаинформации с данными о заболевании к звуковым файлам и анализа частотного состава записей при помощи быстрого преобразования Фурье.

5. Программа Viscope Visual Stethoscope Software является автономной и не связана с какимлибо производителем стетоскопов. Ее основные возможности – масштабирование графика амплитудных изменений звука, отображение записей нескольких пациентов для визуального сравнения и оценки длительности отдельных участков записей.

Проведенный анализ технических и программных характеристик современных электронных стетоскопов показывает, что эти устройства позволяют с высокой точностью регистрировать, усиливать, оцифровывать, фильтровать и записывать результаты аускультативных исследований органов дыхания человека. Однако интерпретация результатов исследования, как и в случае с обычными стетоскопами, во многом зависит от врача, его опыта и ряда других субъективных факторов.

ПО электронных стетоскопов не включает функционал автоматической классификации регистрируемых звуков, следовательно, не может осуществлять автоматическую генерацию расширенной интерпретации результатов анализа ДШ.

Предпосылки к автоматической интерпретации записей ДШ 

Проведенный анализ особенностей ПО регистраторов звуков дыхания выявил необходимость создания специализированного ПО, которое будет интегрироваться с ПО электронных стетоскопов и обеспечит применение современных методов анализа и классификации слабых акустических сигналов.

Значимые результаты по исследованиям автоматической классификации ДШ можно найти в работах . Большинство из них акцентируют внимание на способах выделения разделительных классификационных признаков, а также на методиках регистрации звуков дыхания. Непосредственно сама процедура классификации, как правило, отодвигается на второй план, зачастую исследователи ограничиваются применением классических алгоритмов.

Построение классифицирующих систем входит в перечень задач, решаемых совокупностью методов автоматического анализа, за которыми закреплено собирательное название Data mining, в отечественных источниках также применяется название «Интеллектуальный анализ данных», ИАД . Одной из главных особенностей этого направления является большая зависимость результатов классификаций от качества обучающих выборок, то есть от набора данных, на основе анализа которого формируются решающие правила, деревья вывода и другие результирующие формы.

Особенности выборок ДШ исследованы в работах . Анализ результатов показывает существенную зависимость данных от некоторых характеристик стетоскопов. Очевидно, при построении автоматического интерпретатора записей ДШ необходимо учитывать такие технические характеристики регистраторов сигналов, как амплитудночастотную характеристику, частоту дискретизации, уровень квантования сигнала, регистрируемого стетоскопом.

Различия в этих признаках приводят к существенным вариациям сигналов, зарегистрированных при одной и той же патологии, что создает большие сложности для формирования обучающих выборок и построения универсального классификатора ДШ. Выявленное техническое противоречие можно преодолеть с помощью специальных средств адаптации программы интерпретатора к модели электронного стетоскопа.

Архитектура системы автоматической интерпретации записей ДШ с адаптацией к средствам регистрации сигналов 

Рассмотрим архитектуру программной системы, решающей задачи анализа акустических шумов с адаптацией правил интерпретации к средствам регистрации сигналов. Система предназначена для расширения функциональных возможностей программ, поставляемых в комплекте с электронными стетоскопами. В ее структуре можно выделить четыре обязательных компонента:

 модуль сопряжения;
 
 подсистема подготовки моделей объектов классификации;
 
 подсистема настройки (адаптации) к модели регистратора сигналов;
 
 классификатор сигналов.
 
Один из вариантов такой системы, интегрирующей аппаратно-программный комплекс электронного стетоскопа Littmann 4100 (1) и средства интерпретатора (2), показан на рисунке 1.

Электронный стетоскоп (Littmann 4100)

ПО регистрации результатов исследования (Littmann StethAssist)

Аудиофайлы

Модуль сопряжения

Загрузка сырых данных

Подсистема подготовки данных

Модуль функциональных преобразований

Выделение дыхательных циклов

Выделение СПМ

Понижение размерности

Фильтрация

Ядро классификатора

Редактор выборки

Хранилище описаний объектов

Подсистема настройки на стетоскоп

Редактор ЛП

Модуль фаззификации 1

ЛП

Правила

Модуль фаззификации 2

Модуль автоматической генерации продукционных правил

Модуль логического вывода

Модуль представления результатов

Модуль сопряжения выполняет роль интерфейса, обеспечивая загрузку файлов с записями ДШ, созданных с помощью электронного стетоскопа. Учитывая, что программы этих устройств обеспечивают регистрацию результатов исследования не только в собственном формате, но и в форматах, доступных для воспроизведения стандартными средствами (форматы wav, mp3, txt), набор конверторов получается довольно ограниченный.

Подсистема подготовки моделей объектов классификации предназначена для формирования различных описаний ДШ в пространстве дискретных признаков. Она решает задачи первичной обработки данных: фильтрации, нормализации, расчета спектральной плотности мощности (СПМ) и аттрактора, а также формирование на основе аттрактора вектора вторичных признаков.

Подсистема настройки (адаптации) к модели регистратора сигналов позволяет производить адаптацию интерпретатора под конкретные модели стетоскопов.

Ее основное назначение – генерация продукционных правил, которые используются базовым ядром интерпретатора для решения задачи классификации образца ДШ, поступившего от электронного стетоскопа. Все правила имеют унифицированную структуру, в качестве консеквента в ней используется наименование класса, который может совпадать с видом патологии, а для формирования антецедента используется модель класса спектров ДШ.

Особенность этих моделей заключается в использовании нечетких переменных для представления спектров ДШ. Экспериментально доказано, что под каждую модель стетоскопа необходима генерация собственных вариантов классов спектров ДШ. Для решения этих задач в состав подсистемы настройки включены редакторы лингвистических переменных (ЛП) и функций принадлежности (ФП), модуль фаззификации и модуль автоматической генерации продукционных правил.

Учитывая, что разные модели стетоскопов могут обеспечивать разные уровни громкости записей ДШ, количество лингвистических переменных, необходимых для фаззификации ДШ, а также границы нечетких множеств для каждого терма могут редактироваться с учетом размаха выборки моделей ДШ, построенных с использованием СПМ. Переход от рассчитанного спектра мощности ДШ к модели, представленной совокупностью нечетких признаков, описывающих ординаты СПМ, осуществляется с помощью модуля фаззификации 1.

В состав этой подсистемы включен также специальный редактор функциональных преобразований, с помощью которого можно создавать модели ДШ на основе линейных и нелинейных преобразований, включающих построение аттракторов, вычисление длительности дыхательных циклов и т.п.

Основным компонентом подсистемы настройки является модуль автоматической генерации продукционных правил. Его назначение – генерация нейроподобной иерархической структуры (НИС), задающей обобщенные представления обо всех объектах анализируемой обучающей выборки. НИС отражает характерные закономерности классов, представленных в выборке . С помощью каждой модели стетоскопа создается своя обучающая выборка ДШ и генерируется отдельный вариант НИС, которая затем конвертируется в соответствующий набор классификационных правил. Классификатор сигналов (ядро интерпретатора) составляют модули, инвариантные к виду стетоскопов: редактор обучающей выборки, модуль фаззификации 2, модуль логического вывода и модуль представления результатов.

С помощью редактора обучающей выборки можно просматривать и редактировать загруженную выборку объектов – моделей ДШ.

Модуль фаззификации 2 по своему предназначению аналогичен модулю фаззификации 1. Модуль нечеткого логического вывода решает задачу классификации с помощью построенных продукционных правил и вычисляет значение функции соответствия объекта описанию класса. Модуль представления результатов отображает информацию о функционировании интерпретатора: статистику по результатам классификации наборов данных, детализированные результаты системы нечеткого логического вывода, структуру построенной НИС, структуру сгенерированных продукционных правил. Информация отображается в табличном, текстовом либо графическом виде.

Методика настройки интерпретатора на модель стетоскопа

Настройка программы интерпретатора на модель стетоскопа заключается в формировании правил классификации на основе обучающей выборки, созданной с помощью указанного регистратора. Учитывая, что средства генерации правил инвариантны к модели стетоскопа, основные этапы методики связаны с формированием обучающей выборки (рис. 4).

Данные аускультативного исследования могут быть получены различными способами, поэтому в программе предусмотрена возможность указания параметров источника данных и способа их получения. Для этого (этап 1) указывается тип специфичного модуля-приемника входных данных (wav, mp3, txt).

Для описания ДШ можно использовать различные системы признаков. Средства подготовки данных (этап 2.1) предусматривают расчет частотных признаков (спектров мощности, автокорреляционной функции, кепстральных коэффициентов), временных признаков (длительность фаз дыхательного цикла).

Для полученных таким образом групп признаков определяются тип признаков (однородные/неоднородные) и наличие взаимосвязи (коррелированные/некоррелированные) (этап 2.2).

Если признаки являются однородными и взаимосвязанными, допускается выполнение процедуры укрупнения признаков, что позволяет сократить размерность описания объектов, а также может привести к улучшению качества классификации .

После представления исходных признаков в наиболее подходящем для анализа виде следует преобразовать их к нечеткому представлению. При этом преобразование к нечеткому виду должно быть задано исходя от решаемой задачи и определяться структурой ЛП признака (этап 3).

После выполнения всех перечисленных этапов следует запустить процедуру построения ядра НИС с последующим выделением продукционных правил (этап 4).

Эксперт, анализируя полученные на предыдущем этапе продукционные правила, может (этап 5) корректировать структуры ЛП признаков для увеличения точности классификации (этап 5.1).

После выполнения всех этапов настройки возможны загрузка рабочих выборок объектов, расчет и визуализация результатов их интерпретации (этап 6).

Результаты испытаний системы автоматической интерпретации записей ДШ с адаптацией к средствам регистрации сигналов Испытания системы были произведены с использованием трех разных устройств регистрации ДШ: 3M Littmann 4100, авторского устройства и устройства цифровой электронной аускультации КoРА-03М1 .

Регистрация ДШ осуществлялась в трех точках корпуса пациента. В качестве испытуемых выступали как здоровые люди, так и пациенты с патологиями органов дыхания. С помощью субъективной классификации экспертом (врачом высокой квалификации с хорошим состоянием органов слуха) из всех зарегистрированных записей сформированы два множества образцов ДШ (норма, патология).

Электронные стетоскопы, участвовавшие в испытаниях, имеют существенные различия в своих характеристиках. С помощью устройства 3M Littmann 4100 регистрировались образцы шума с частотным диапазоном 0–4 кГц, при частоте дискретизации 8 кГц и разрешении 16 бит. Записи аворского устройства имеют частотный диапазон 0–5кГц, частоту дискретизации 11025 Гц, разрешение 16 бит. Коллекция записей ДШ, сделанная с помощью устройства КoРА-03М1, иллюстрирует легочные шумы в частотном диапазоне 0–3 кГц при частоте дискретизации 4 кГц и разрешении 16 бит. 

Состав обучающей выборки (ОВ) и тестовой выборки (ТВ) приведен в таблице 1.

Классификация записей проводилась по ОВ и ТВ, которые не пересекались. Анализ результатов работы программы выявил существенные различия в структурах НИС-классификаторов , сформированных для разных средств регистрации шумов (табл. 2). Однако варианты сгенерированных правил показали близкие по точности результаты работы интерпретаторов ДШ для каждой модели электронного стетоскопа (табл. 3).

В заключение отметим, что предложенная методика и программные средства позволяют существенно расширить возможности ПО, поставляемого в комплекте с электронными стетоскопами. Дальнейшее развитие этого направления исследований позволит перейти к классификации ДШ по видам патологий и будет способствовать повышению качества аускультативного исследования органов дыхания.

