Интеллектуальный анализ данных направлен на
исследование больших объемов информации с целью выявления зависимостей между данными. Ассоциативные правила (association rule)  один из
хорошо изученных классов зависимостей, которые
отражают, какие признаки или события встречаются совместно и насколько часто это происходит.
В настоящее время ассоциативные правила нашли
широкое применение в медицине, информационной безопасности, анализе компьютерных сетей и
маркетинге при решении задач диагностики и прогнозирования.
При поиске ассоциативных правил анализируемое множество данных обычно описывается бинарным контекстом – матрицей, строки которой соответствуют объектам рассматриваемой предметной области, а столбцы – признакам этих объектов.
Единичное значение элемента матрицы трактуется
как наличие у объекта соответствующего признака,
а нулевое  как его отсутствие. Бинарное представление данных значительно расширяет математический аппарат для их исследования. Современные
методы поиска ассоциативных правил базируются
преимущественно на анализе формальных понятий
и теории вероятностей . Анализ формальных
понятий, как прикладная ветвь алгебраической теории решеток, является удобным математическим
аппаратом описания методов поиска ассоциативных правил .
Главная проблема при поиске ассоциативных
правил  огромное число правил, возникающих
при исследовании больших бинарных контекстов.

Это существенно усложняет экспертный анализ
выявленных ассоциативных правил. Для решения
этой проблемы используются различные меры значимости, такие как поддержка (support) и достоверность (confidence) . С их помощью найденные ассоциативные правила фильтруются, и для анализа
предъявляются только те, для которых значения
мер значимости превышают заданные пороговые
значения. Подобная фильтрация, конечно, уменьшает число правил, но не решает проблему размерности полностью. Не помогает и расширение мер
значимости . Часто после фильтрации все
равно остается значительное число ассоциативных
правил, при этом многие из них избыточные. Ассоциативное правило считается избыточным, если
его удаление из множества правил не приводит к
потере информации о связях между данными в рассматриваемой предметной области.
Существуют различные формальные определения избыточных ассоциативных правил и методы
их устранения . Наиболее развиты методы
устранения избыточности для строгих ассоциативных правил (strong association rules). Такие правила
имеют достоверность 1 и считаются самыми важными. Для этих правил имеются плотная параллель
с функциональными зависимостями из теории реляционных БД, а также четкое понятие избыточности . Строгие ассоциативные правила представляют интерес для тех приложений, где требуется
высокая степень уверенности в обнаруженных зависимостях между данными, например, в медицине
и информационной безопасности .
Множество ассоциативных правил, не содержащее избыточных (в некотором смысле) правил,
принято называть базисом. В настоящее время известен ряд алгоритмов, позволяющих строить различные базисы для строгих ассоциативных правил.
Наиболее значимыми являются канонический и
минимаксный базисы. Канонический базис (или
базис Дюкена–Гига) состоит из минимального
числа ассоциативных правил, рекуррентно описываемых в терминах псевдосодержаний . Канонический базис глубоко исследован в анализе
формальных понятий, однако все предложенные на
сегодняшний день алгоритмы его построения в
большей степени представляют теоретический,
чем практический интерес . Минимаксный базис состоит из строгих ассоциативных правил, имеющих минимальную посылку и максимальное
следствие . Для построения минимаксного базиса существует ряд хорошо апробированных
практикой алгоритмов. К ним относится, например, алгоритм Close . Исследования показали, что в построенных канонических и минимаксных базисах остается некоторая избыточность,
которая может быть устранена на основе выводимостей, подобных аксиомам Амстронга, известным
в теории реляционных БД для функциональных зависимостей.
В данной статье для строгих ассоциативных
правил предложен алгоритм MClose  модификация известного алгоритма Close. Алгоритм MClose
позволяет в процессе построения минимаксного
базиса устранять избыточность с сохранением
поддержки и достоверности без дополнительного
обращения к исходному бинарному контексту.
Результирующий базис назван сжатым строгим базисом. Введено понятие избыточного ассоциативного правила. Приведены выводимости, доказывающие корректность предлагаемого алгоритма, а
также результаты вычислительных экспериментов.
Поскольку алгоритм Close основан на анализе формальных понятий, необходимые определения и
обозначения этой теории возьмем из работ .
Основные определения и обозначения
анализа формальных понятий
Пусть для некоторой предметной области определены два непустых конечных множества G и M,
объектов и признаков соответственно. Предполагаем, что все объекты в G и признаки в M различны.
Пусть задано отношение инцидентности
между множествами G и M. Существование в I
пары, означает, что объект g
имеет признак m и, наоборот, признак m характерен
для объекта g. Тройку принято называть контекстом предметной области.
Выберем в два любых элемента. Определим для них два отображения:

множество признаков, присущих объекту g;
множество объектов, обладающих признаком m.
Отображения  и  обобщаются на произвольные множества следующим образом.
Следовательно,   множество признаков,
общих для всех объектов из A, а   множество
объектов, которые обладают всеми признаками из
B. Полагаем, что и: пустому
множеству объектов присущи все признаки из M и
каждый объект рассматриваемого контекста
 обладает пустым множеством признаков.
Обычно в анализе формальных понятий для
отображений  и  применяется единое обозначение, а приведенные выше формулы для ,
 записываются так. 
Если, то обозначения служат сокращенной формой записи множеств  соответственно.
Отображения удовлетворяют свойствам,
вытекающим из их определения и вполне реалистичного и постулируемого в анализе данных положения: расширение (сокращение) множества
признаков уменьшает (увеличивает) число объектов, обладающих этими признаками. Формально
эти свойства можно выразить в виде следующих
утверждений.
Утверждение 1. Для всякого контекста  и любых  верны свойства:
 антимонотонность;
 экстенсивность.
Множество можно трактовать
как набор признаков, которые всегда появляются в
объектах контекста вместе с признаками из B1, причем это множество является наибольшим по включению в пределах .
Очевидно, что , где  множество признаков, свойственных всем объектам из G.
Для подмножеств множества G справедливо утверждение 2, аналогичное утверждению 1.
Утверждение 2. Для всякого контекста  и любых верны свойства:
 антимонотонность;
 экстенсивность.
Множество можно интерпретировать как наибольшее по включению множество
объектов, обладающих всеми признаками, которые
имеют объекты из A1.
Заметим, что, согласно утверждениям 1 и 2,
отображения  и  составляют пару соответствий
Галуа между множествами 2G и 2M, частично упорядоченными по включению . Здесь традиционно 2G и 2M – совокупность всех подмножеств рассматриваемых множеств G и M соответственно.
Известно, что для соответствий Галуа   и 
справедливо равенство,
или в единых обозначениях.
Двойное применение отображения определяет оператор замыкания на 2M в алгебраическом
смысле . Ему присущи
 рефлексивность;
 монотонность;
 идемпотентность.
Справедливость этих свойств вытекает из
утверждений 1 и 2. Множество признаков,
для которого, называется замкнутым относительно оператора в контексте.
Принято говорить, что множество является замыканием для в контексте. Заметим, что, исходя из  и , при замыкание для можно вычислить по формуле.

Если , то всегда.
Важно отметить, что применение формулы 
позволяет найти для заданного множества признаков замыкание за один просмотр контекста.
Ассоциативные правила
и основные меры их значимости
Определим ассоциативное правило, используя
приведенные выше понятия и обозначения. Ассоциативным правилом на множестве признаков контекста называется упорядоченная пара.
Принято ассоциативное правило записывать в виде. В ассоциативном правиле
множества Х и Y называют посылкой (или
причиной) и заключением (или следствием) соответственно . В анализе ассоциативных правил
часто полагают, что посылка и заключение – непустые непересекающиеся множества. С формальных
позиций эти ограничения несущественны.
Применительно к заданному контексту  всякое ассоциативное правило количественно характеризуется с помощью двух числовых функций: поддержка,  достоверность . Поддержка и достоверность ассоциативного правила определяются через понятие
поддержки множества признаков.
Поддержка множества признаков  в
контексте отношение числа объектов, которым присущи признаки X, к общему числу
объектов, представленных в этом контексте.

Величину  можно интерпретировать как частоту встречаемости в контексте  объектов, имеющих признаки Х. Из формулы  следует, что для любого  значение  неизменно находится в естественных границах
. Чем ближе значение  к 1, тем большее число объектов рассматриваемого контекста
обладает всеми признаками из X. В силу антимонотонности отображения «» поддержка множества
признаков также удовлетворяет свойству антимонотонности: для всякого контекста  и
любых  при верно неравенство.

Согласно , поддержка множества признаков
не может превышать поддержку любого из его подмножеств. Так, для произвольного  всегда.
Множество признаков  называется частым в контексте , если его поддержка
больше или равна заданному пороговому значению. Если , то X называется
частым замкнутым множеством признаков в. Частые множества и частые замкнутые множества признаков традиционно служат основой для поиска ассоциативных правил в заданном контексте.
Поддержкой ассоциативного правила
относительно контекста  называется величина,

указывающая, какая доля объектов этого контекста
имеет признаки . Достоверность  ассоциативного правила относительно контекста  определяется как отношение числа
объектов, обладающих всеми признаками из ,
к числу объектов, которым свойственны только
признаки Х.
Достоверность ассоциативного правила через
функцию поддержки выражается формулой. 
Заметим, что достоверность определяется формулой  только для тех ассоциативных правил, для которых . Если  (в контексте нет ни одного объекта, который обладал бы
признаками X), то также . В этом особом случае полагают . Исходя из, достоверность ассоциативного правила
при произвольных  всегда находится в границах . Чем ближе значение к 1, тем с большей уверенностью
можно сказать, что признаки Y появляются в объектах рассматриваемого контекста вместе с признаками X.
Ассоциативное правило  называется минимаксным, если не существует другого ассоциативного правила, такого, что.
В анализе ассоциативных правил часто достоверность ассоциативного правила называют величиной его значимости. Самыми значимыми считаются строгие ассоциативные правила  правила с
достоверностью 1. Известен критерий наличия
в контексте строгого ассоциативного правила: достоверность ассоциативного правила относительно контекста  равна 1 тогда и
только тогда, когда. Заметим, что данный
критерий тривиальным образом выполняется для.
Из определения замыкания и формулы  следует, что для всякого контекста  и любого множества  поддержка относительно
 совпадает с поддержкой X.

Таким образом, если  является частым
множеством в , то  также является
частым в этом контексте. Следует отметить, что в
худшем случае число частых замкнутых множеств
признаков контекста  совпадает с числом частых множеств признаков и экспоненциально зависит от . Однако на практике обычно
число частых замкнутых множеств значительно
меньше числа частых множеств. Примеры контекстов с полиномиальным относительно  числом
частых замкнутых множеств можно найти в .
Использование формулы  позволяет при поиске
ассоциативных правил вместо частых множеств
признаков применять частые замкнутые множества
и тем самым сокращать пространство поиска ассоциативных правил. В силу  и  расширение исходного контекста путем добавления в него новых
объектов не изменяет замыкания , но может
расширить состав объектов, которым присущи все
признаки из . Это означает, что при такой трансформации исходного контекста возможно лишь
увеличение поддержек для ранее найденных замкнутых множеств признаков. Поэтому, если эти
множества были частыми, они по-прежнему останутся частыми.
Задача поиска ассоциативных правил
и известные алгоритмы ее решения
Пусть заданы контекст  и вещественные числа из . Будем говорить, что
является ассоциативным правилом в
, если выполняются два условия.

Требуется найти для заданного контекста
 множество AR всех ассоциативных правил. Заметим, что искомый набор правил AR параметризирован относительно пороговых
значений. Например, при  условие 
отражает естественные границы поддержки. Данная ситуация свидетельствует о том, что нет ограничений на частоту появления признаков  в
. При условие  приводит к равенству. В этом случае будем иметь
строгие ассоциативные правила.
Решение поставленной задачи предполагает выполнение следующих двух этапов: вначале построение различных подмножеств множества M, вычисление для каждого из них поддержки и проверка
условия ; далее генерация ассоциативных правил с учетом найденных частых наборов и проверка условия . Наличие на обоих этапах комбинаторных переборов приводит к значительным вычислительным затратам для нахождения решения
данной задачи. Очевидно, что, чем больше пороговые значения, тем быстрее находится соответствующий набор ассоциативных правил и тем меньшее
число правил будет содержать этот набор. К сожалению, в худшем случае время поиска всех
ассоциативных правил в заданном контексте  экспоненциально зависит от .
К настоящему времени разработано большое
число алгоритмов поиска ассоциативных правил.
Их обзор представлен в работах . Основополагающими среди них являются алгоритмы Apriori
и Close. Алгоритм Apriori использует свойство антимонотонности функции поддержки . Он генерирует ассоциативные правила для любых исходя из найденных частых множеств
признаков. Алгоритм Close представляет класс алгоритмов, генерирующих только ассоциативные правила, то есть строгие ассоциативные
правила. Этот алгоритм порождает строгие ассоциативные правила из частых замкнутых наборов
признаков . Переход от частых множеств к частым замкнутым множествам позволяет сузить
пространство поиска. Другим достоинством алгоритма Close и его многочисленных версий является
способность формировать минимаксные ассоциативные правила.
Пример 1. Рассмотрим контекст ,
представленный в таблицах 1 и 2, где множество объектов, множество признаков, матрица инцидентности.
Заметим, что именно этот контекст традиционно
используется в публикациях по алгоритмам поиска
ассоциативных правил для демонстрации и тестирования этих алгоритмов . В таблицах 1, 2 и далее при написании множеств для краткости опущены фигурные скобки, запятые между элементами этих множеств и элементы расположены в
лексикографическом порядке. Например, вместо
 записано abc, а вместо .


Для рассматриваемого контекста при  и
 алгоритм Apriori приводит к семнадцати
строгим ассоциативным правилам. 
Полученное множество AR содержит много избыточных правил в том смысле, что, если их исключить, то они выводимы из оставшихся правил.
Это следующие ассоциативные правила.
Некоторые из них удаляются алгоритмом Close
в процессе построения множества AR. В результате
алгоритм Close извлекает лишь восемь минимаксных строгих ассоциативных правил,

что в два раза меньше чем в . Алгоритм Close
находит минимаксные строгие ассоциативные правила по следующим частым замкнутым наборам
признаков. Все эти правила
имеют допустимые поддержки.
Классический алгоритм Close
Суть классического алгоритма Close заключается в пошаговом извлечении генераторов и частых
замкнутых наборов признаков . Множество
 называется генератором замкнутого набора
признаков , тогда и только тогда, когда  и не существует другого множества
, такого, что . Другими словами,
генератор замкнутого набора признаков X  наименьшее по мощности множество признаков, имеющее замыкание X. Число признаков, входящих в
генератор ρ, называется мощностью этого генератора. Если , то  является k-генератором.
На вход алгоритма Close подаются исходный
контекст  и пороговое значение. Изначально множество AR считается пустым и .
На первом шаге в качестве k-генераторов рассматриваются все одноэлементные подмножества
множества M. Замыкание  для генератора ρk
вычисляется по формуле . Поддержка для 
находится по формуле . Если , то по
частому замкнутому множеству  строится минимаксное строгое ассоциативное правило

и сохраняется в AR. Согласно  и , для него. То,
что ассоциативное правило  является минимаксным, следует из определения генератора. Очевидно, что различные генераторы могут порождать
одинаковые замыкания. Так, для контекста из примера 1 имеем: . Поэтому  содержит минимаксные строгие ассоциативные правила.
После генерации ассоциативного правила по
 создаются кандидаты в генераторы для
следующей итерации. Каждый такой кандидат
формируется путем объединения двух генераторов, обладающих одинаковыми первыми k – 1 признаками. Далее проверяется, вложен ли найденный
кандидат в . Если вложен, то он исключается из
рассмотрения. После нахождения всех генераторов осуществляется переход к следующей итерации. Алгоритм Close завершает работу, когда исчерпаны все генераторы.
Множество ассоциативных правил, полученных в результате работы алгоритма Close, образует
минимаксный базис строгих ассоциативных правил контекста . Корректность алгоритма Close доказана в работе . Алгоритм Close
может быть модифицирован так, чтобы в результирующее множество AR не попадали заведомо избыточные строгие ассоциативные правила.
Алгоритм MClose для построения
сжатого строгого базиса
Верна следующая теорема.
Для любого контекста  и произвольных справедливы следующие
свойства строгих ассоциативных правил

D1. Рефлексивность.
D2. Пополнение посылки.
D3. Аддитивность.
D4. Проективность.
D5. Транзитивность.
D6. Псевдотранзитивность.
Свойства (или выводимости) D1–D6 позволяют
из некоторого множества строгих ассоциативных
правил вывести многие другие правила без дополнительного сканирования контекста. С одной стороны, именно выводимости D1–D6 обусловливают
экспоненциальное число возможных строгих ассоциативных правил для рассматриваемого контекста и неоднозначность их представления. С другой
стороны, они предоставляют возможность построить для множества строгих ассоциативных правил
сжатый строгий базис (concise strong basis), компактно описывающий связи между данными изучаемой предметной области.
Примечательно, что выводимости, подобные
D1–D6, справедливы для функциональных зависимостей, имеющих место в теории реляционных БД,
где их принято называть аксиомами Амстронга. Такое совпадение не случайно, поскольку строгие ассоциативные правила можно рассматривать как
особый случай функциональных зависимостей .
В работе  выводимости D1–D6 доказаны применительно к функциональным зависимостям. Однако они могут быть доказаны непосредственно
для ассоциативных правил на основе соответствий
Галуа. Важно, что выводимости D1, D3, D4, D5 гарантируют сохранение поддержки. Это означает,
что результатом применения их ассоциативным правилом всегда является ассоциативное правило. Поэтому эти выводимости применяются в алгоритме MClose для построения сжатого
строгого базиса. Введем определения избыточного
ассоциативного правила и сжатого строгого базиса
для множества ассоциативных правил.
Пусть AR  множество строгих ассоциативных
правил, каждое из которых справедливо для контекста . Будем говорить, что строгое
ассоциативное правило логически следует
из множества AR, если оно может быть выведено из
AR с помощью выводимостей. Тот
факт, что строгое ассоциативное правило логически следует из AR, будем обозначать так.
Строгое ассоциативное правило называется избыточным в AR, если.
Множество строгих ассоциативных правил неизбыточное, если оно не содержит избыточных строгих ассоциативных правил. Множество CSB называется сжатым строгим базисом множества AR,
если оно неизбыточное и состоит только из минимаксных строгих ассоциативных правил. Данное
определение сжатого строгого базиса указывает
способ его нахождения  генерация минимаксных
строгих ассоциативных правил (например, с помощью алгоритма Close) и устранение среди них избыточных.
Распознавание избыточного строгого ассоциативного правила в AR основано на проверке логического следования.

Алгоритм такой проверки использует понятие
замыкания множества признаков относительно
множества AR и является полиномиальным относительно  и . Замыканием множества  относительно AR (обозначается ) называется множество всех признаков, таких, что верно логическое следование. Заметим, что
неизменно. Из выводимостей D1, D3, D4 вытекает справедливость следующего утверждения.
Утверждение 3. Логическое следование
 имеет место тогда и только тогда, когда .
Отсюда всегда.
В силу утверждения 3, чтобы убедиться в справедливости , достаточно вычислить относительно и проверить включение. Если, то строгое ассоциативное правило избыточно в AR, иначе – не избыточно.
Алгоритм вычисления целиком базируется
на выводимостях D1, D3, D4, D5 и сводится к выполнению следующих действий. Сначала полагается. Далее осуществляются просмотр правил из
AR и пополнение замыкания по следующему принципу: если для правила  AR верно включение, то множество добавляется к . Этот
процесс повторяется до тех пор, пока изменяется. Поскольку множества M и AR конечные, то процесс вычисления конечен.
Заметим, что процесс исключения избыточных
строгих ассоциативных правил не требует доступа
к контексту  и поэтому время его выполнения незначительно по сравнению со временем получения частых замкнутых множеств признаков. Чтобы исключить добавление заведомо избыточного строгого ассоциативного правила в AR,
необходимо всякий раз после построения  выполнять следующие действия. Если посылка 
найденного правила не равна , то необходимо
найти замыкание  относительно вычисленного
множества AR. Если , то минимаксное ассоциативное правило является избыточным (по утверждению 3), иначе оно включается
в AR. После завершения генерации минимаксных
строгих ассоциативных правил обязательно требуется дополнительный просмотр результирующего
множества AR с целью обнаружения оставшихся
избыточных правил. Такие правила вполне возможны: они неизбыточные по отношению к ранее
выявленным правилам, однако после пополнения
AR новыми правилами могут оказаться избыточными. Таким образом, по построению результирующее множество AR состоит из минимаксных
строгих ассоциативных правил и является неизбыточным. Заметим, что оперативное удаление избыточных правил сдерживает рост мощности AR и
снижает время выполнения алгоритма. Опишем алгоритм MClose.

В описании алгоритма MClose процедуры GenClosure и Gen-Generator аналогичны одноименным
процедурам классического алгоритма Close (см.
). Процедура SX осуществляет построение
замыкания . Процедура Non-Redundancy, выполняемая на шаге 17 алгоритма MClose, устраняет в
AR избыточные строгие ассоциативные правила
после завершения его генерации.
Пример 2. Для контекста, представленного в
таблицах 1 и 2, при  минимаксный
базис состоит из восьми правил , в котором избыточными являются.

Сжатый строгий базис, построенный алгоритмом MClose, содержит только четыре минимаксных строгих ассоциативных правила.
Заметим, что на основе CSB можно получить
всякое правило из  с помощью алгоритма вычисления. Так, чтобы найти максимальное следствие для посылки bc, достаточно вычислить
относительно CSB. В результате имеем.
Отсюда. Поскольку и, то ассоциативное правило является
строгим.

Программная реализация алгоритма MClose
и результаты экспериментов
Алгоритм MClose программно реализован на
языке программирования С++ в среде разработки
Embarcadero RAD Studio XE8. Исходными данными для него служат контекст  и пороговое значение поддержки. Для ввода исходных
данных имеется интерфейс.
Для
удобства пользователя пороговое значение вводится в виде целого положительного числа.
Результатом работы алгоритма MClose являются
все выявленные частые замкнутые множества признаков и сжатый строгий базис.
Значения поддержек масштабируются и выводятся
в виде целых положительных чисел.
В программе существует возможность изменения результирующего множества ассоциативных
правил путем добавления и удаления отдельных
правил. Это сделано для того, чтобы эксперт мог
исключить из рассмотрения ассоциативные правила, которые, на его взгляд, не отвечают реальной
действительности, и добавить существенные правила. Допускается сокращение признакового пространства (вкладка «Анализ признаков») с помощью методов, описанных в работе . Предусмотрена функция вычисления следствия для всякой
заданной посылки относительно сжатого строгого
базиса. Для оценки эффективности алгоритма
MClose были также программно реализованы алгоритмы Apriori и Close.
Алгоритмы Apriori, Close и MClose сравнивались по числу сгенерированных строгих ассоциативных правил и времени работы. Эксперименты
осуществлялись на компьютере с процессором Intel® Core™ i5 CPU  2.30 GHz и ОЗУ размером
4 ГБ. Эксперименты выполнялись на контекстах
различной размерности и плотности, сгенерированных случайным образом. Результаты экспериментов представлены в таблице 3.

В таблице 3 для всякого анализируемого контекста  указаны число объектов,
  число признаков,  плотность
контекста, где n задает число единичных элементов
матрицы инцидентности I. Контекст из 10 000 объектов был сформирован многократным копированием контекста, состоящего из 500 объектов.
Из таблицы 3 видно, что алгоритмы Close и
MClose эффективнее алгоритма Apriori как по
числу извлеченных строгих ассоциативных правил,
так и по времени работы. Алгоритм MClose по времени работы сопоставим с алгоритмом Close. Однако алгоритм MClose позволяет более чем в два
раза уменьшить мощность минимаксного базиса,
формируемого алгоритмом Close.
Заключение
Современные методы и средства поиска ассоциативных правил в больших массивах данных приводят к значительному числу правил, большинство
из которых являются избыточными. Усилия многих исследователей направлены на разработку методов устранения избыточности в представлении
ассоциативных правил. Для решения этой проблемы применительно к строгим ассоциативным
правилам предложен алгоритм MClose, являющийся модификацией известного алгоритма Close
и основанный на свойствах частых замкнутых множеств. Предложенный алгоритм формирует для
заданного контекста сжатый строгий базис – неизбыточное множество минимаксных строгих ассоциативных правил с сохранением поддержки.
Вычислительные эксперименты показали, что алгоритм MClose существенно сокращает число
извлеченных строгих ассоциативных правил без
потери информации о связях между данными анализируемой предметной области. Перспективны
исследования, направленные на устранение избыточности для ассоциативных правил с любыми
поддержками и достоверностями.