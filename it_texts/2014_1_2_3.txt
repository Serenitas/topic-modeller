Оценка качества моделей прогнозирования на основе строго бинарных деревьев и модифицированного алгоритма клонального отбора



1. Введение 

Анализ временных рядов (ВР), описывающих процессы с короткой актуальной частью (порядка 20–30 значений), играет важную роль при решении многих практических задач, например, при решении задач, связанных с прогнозированием различных социально-экономических процессов. При этом все чаще при разработке моделей прогнозирования ВР с короткой актуальной частью (коротких ВР) используются различные технологии искусственного интеллекта, применение которых позволяет обеспечить получение адекватных оценок возможных изменений в поведении ВР на основе их известных значений и принятие соответствующих управленческих решений [1–9]. 

Одной из современных технологий, которая может быть использована при разработке моделей прогнозирования коротких ВР, является технология, реализующая применение искусственных иммунных систем (ИИС), основанных на принципах естественной иммунной системы и хорошо зарекомендовавших себя при решении широкого спектра прикладных задач [1, 10, 11]. Эффективность использования аппарата ИИС, в частности, алгоритма клонального отбора и механизмов супрессии антител при решении задач интерполяции, экстраполяции и прогнозирования, доказанная в работах зарубежных исследователей [10], подтверждает перспективность применения ИИС для решения задачи прогнозирования коротких ВР. Успешный опыт использования моделей прогнозирования ВР, определяемых с применением аналитических зависимостей, формируемых на основе строго бинарных деревьев (СБД), полученных при реализации модифицированного алгоритма клонального отбора (МАКО), для прогнозирования социально-экономических процессов свидетельствует о целесообразности проведения дальнейших разработок в данном направлении [5–8]. Обычно качество моделей прогнозирования коротких ВР оценивается с применением какого-либо одного показателя, например, с применением средней относительной ошибки прогнозирования, значение которой должно быть минимизировано [1–8, 12, 13]. В то же время для коротких ВР может быть выполнен расчет и других показателей качества моделей прогнозирования, таких как коэффициент детерминации, среднеквадратическая ошибка прогнозирования, минимальное и максимальное значения ошибки прогнозирования, коэффициент несовпадения тенденций и т. п. [14–16]. Задача одновременного учета значений таких показателей при оценке качества модели прогнозирования представляет собой задачу многокритериальной оптимизации, которая с той или иной долей успеха может быть решена только высококвалифицированным экспертом-аналитиком. Однако одновременный учет даже каких-либо двух показателей качества моделей прогнозирования обеспечил бы существенное повышение точности прогнозирования коротких ВР. В частности, учет, наряду со значением средней относительной ошибки прогнозирования значения показателя несовпадения тенденций, позволил бы исключить из рассмотрения модели прогнозирования, имеющие малые значения средней относительной ошибки прогнозирования, но при этом характеризующиеся большими значениями показателя несовпадения тенденций. Так как при реализации МАКО для оценки качества моделей прогнозирования на основе СБД с целью отбора «лучшей» модели применяется традиционный подход, основанный на минимизации значения средней относительной ошибки прогнозирования [5–8], то можно говорить об актуальности разработки нового подхода к оценке качества моделей прогнозирования на основе СБД, который позволил бы обеспечить одновременный учет значений средней относительной ошибки прогнозирования и показателя несовпадения тенденций. 

2. Прогнозирование на основе строго бинарных деревьев и модифицированного алгоритма клонального отбора МАКО, который позволяет при приемлемых временных затратах сформировать на основе СБД аналитическую зависимость, наилучшим образом описывающую известные значения ВР и обеспечивающую получение минимального значения аффинитета Aff (affinity) — средней относительной ошибки прогнозирования 

AFER (Average Forecasting Error Rate): При этом возможные варианты аналитических зависимостей кодируются в ви ,Ab которые должны осуществлять распознавание антигенов Ag — из-

,Ab де антител вестных значений ВР. В качестве «лучшего» антитела выбирается антитело обеспечивающее минимальное значение аффинитета Aff [1, 5–8]. 

Антитело Ab представляет собой символьную строку, элементы которой выбираются из трех предварительно заданных символьных алфавитов [5–8]: Предполагается, что арифметические операции являются двухместными, а применение функционала должно предшествовать применению арифметической операции [5, 6]. Применение трех символьных алфавитов обеспечивает при реализации МАКО корректное преобразование в аналитические зависимости случайным образом формируемых антител, структура которых может быть описана с помощью СБД [5–8], примеры которых приведены на рис. 1, где рядом с узлами показаны значения их уровней. При использовании почти полных СБД (ППСБД) [6, 8] (см. рис. 1б) удается сформировать более сложные аналитические зависимости, чем в случае применения просто СБД (см. рис. 1а) [5, 7], и, как следствие, обеспечить получение меньших значений средней относительной ошибки прогнозирования AFER [4]. Количество терминальных позиций Term в антителе определяется максимально возможным порядком модели прогнозирования [5–8]. При этом реальный и максимальный порядки модели прогнозирования k и K соответственно удовлетворяют условию: (ввиду возможного кратного вхождения некоторых терминальных символов в запись аналитической зависимости и возможного наличия константы). на момент времени t могут использоваться K  значений ВР: Для антител на основе СБД (см. рис. 1а) при формировании аналитических зависимостей произвольного максимально возможного порядка K  может быть использована рекурсивная процедура интерпретирования антител [6], заключающаяся в рекурсивном преобразовании СБД в символьную строку посредством последовательной записи всех узлов, начиная слева направо и снизу вверх. Терминальные узлы (листья) СБД могут содержать только символы из алфавита терминалов Terminal а остальные узлы формируются из символов алфавита арифметических операций Operation и алфавита функционалов Functional При этом минимальный и максимальный номера позиций антитела, в которых стоят терминальные симво−  соответственно, а длина антитела определяется максимальным номером позиции, в которой стоит терминальный символ. Формирование антитела, соответствующего ППСБД (см. рис. 1б), должно осуществляться так, чтобы обеспечивать корректный результат интерпретирования антитела. В частности, для формирования антитела может использоваться [8]: 

− способ, основанный на применении стандартного подхода к обходу вершин бинарного дерева и реализующий формирование упорядоченного списка символов, находящихся в вершинах ППСБД; 

− способ, основанный на разбиении ППСБД на поддеревья и реализующий сначала с применением стандартного подхода к обходу вершин бинарного дерева для каждого поддерева формирование упорядоченных списков символов, находящихся в его вершинах, а затем — последовательное объединение этих списков. В [8] показано, что применение при реализации МАКО способа формирования антител, основанного на разбиении ППСБД на поддеревья, обеспечивает минимизацию временных затрат на интерпретацию антител в аналитические зависимости. Для антител на основе ППСБД может быть использована рекурсивная процедура интерпретирования антител, но ее применение в этом случае имеет ряд особенностей [8]. Так как для антител на основе ППСБД максимально возможный порядок K всегда является нечетным числом, то само ППСБД может быть представлено в виде композиции одного «левого» поддерева максимально возможного порядка 1,максимально возможного порядка  Для обеспечения максимальной эффективности при использовании для вычисления аффинитета антител формулы (3), применяемой для совместной одновременной минимизации средней относительной ошибки прогнозирования AFER и пока Tendency предлагается при формировании начальной популяции антител, а также при генерации новых антител в ходе реализации МАКО рассмотреть еще одно условие, выполнение которого необходимо для признания случайным образом сгенерированного антитела «пригодным»: антитело считается «пригодным», если соответствующая ему модель прогнозирования обеспечивает совпадение менее половины тенденций ВР. В этом случае при реализации МАКО можно гарантировать, что в процессе смены поколений не увеличатся (и Tendency так даже уменьшатся) как значение показателя несовпадения тенденций и значение средней относительной ошибки прогнозирования AFER  . 

При этом удастся избежать скачков значений показателя несовпадения тенденций как это было, когда при оценке аффинитета антител использовалась только средняя относительная ошибка прогнозирования AFER (1). Далее более подробно рассмотрены шаги, выполняемые при реализации итерационной части МАКО [6]. Так как некоторые математические функции не всегда могут быть применены к операндам, задаваемым в случайно сформированных антителах, то для исключения таких антител из популяции и поддержания ее «жизнеспособности» предлагается присваивать им максимально возможное значение аффинитета 200, которое будет соответствовать максимально возможному значению средней при полном несовпадении относительной ошибки прогнозирования тенденций ВР: Для антитела, содержащего в своих позициях хотя бы одну константу, предлагается производить дополнительную генерацию еще смотреть большее количество вариантов констант в записи искомой аналитической зависимости. Вместе с популяцией клонов Cl  создается массив констант клонов ClConstant, при этом производится дублирование соответствующих строк из массива констант антител Constant. Пусть общее количество полученных клонов Cl антител равно ClP. Экспериментальные исследования. Предлагаемый подход к оценке качества моделей прогнозирования на основе СБД, реализующий оценку аффинитета антител с помощью формулы (3) при соблюдении условий (5) и (6), был использован при реализации МАКО в ходе решения задач прогнозирования тенденций рынка труда в России, в частности, для прогнозирования ВР, описывающего «экономически активное население» (в тыс. чел.). Кроме того, было выполнено построение моделей прогнозирования на основе СБД и МАКО с применением традиционно используемой для оценки аффинитета антител средней относительной ошибки прогнозирования AFER (1). Программная реализация моделей прогнозирования была осуществлена в среде MATLAB R2012b. 

При разработке моделей прогнозирования использовались 18 известных значе с февраля 1999 года по август 2003 года для отсчетов времени по месяцам: февраль, май, август и ноябрь [2], а оценка качества прогнозирования выполнялась для трех значений ВР (ноябрь 2003 года, февраль 2004 года и май 2004 года), т. е. на три шага вперед. На рис. 4 приведены результаты прогнозирования на основе модели 4-го порядка, полученной при использовании предлагаемого (по формуле (3)) подхода к оценке качества моделей прогнозирования в процессе смены 2000 поколений антител. Значения средних относительных ошибок прогнозирования AFER  и на три шага вперед составили соответственно 0.261 и 0.389, количество несовпадающих тенденций равно 0, как для 13 тенденций, используемых при построении модели прогнозирования, так и для тенденций при прогнозировании на три шага вперед, что свидетельствует о применимости разработанной модели для выполнения краткосрочного прогнозирования данного ВР. Аналогичные результаты прогнозирования для рассматриваемого примера могут быть получены и при использовании традиционного (по формуле (1)) подхода к оценке качества моделей прогнозирования, однако их получение может сопровождаться хаотичными изменениями значений показателя несовпадения тенденций Tendency (2), поскольку поиск будет вестись только в направлении убывания значений средней относительной ошибки прогнозирования AFER (1). Использование предлагаемого подхода в ходе смены поколений МАКО позволяет сузить область поиска искомого решения. Поскольку использование МАКО не гарантирует нахождение оптимальной модели прогнозирования, то особое внимание должно уделяться вопросу признания модели прогнозирования в качестве «приемлемой» («субоптимальной»). 

В ходе реализации МАКО при использовании предлагаемого подхода к оценке качества моделей прогнозирования наблюдается, как видно из рис. 5 и 6, постепенное уменьшение значений показателя и количества несовпадения тенденций «лучшего» антитела, в то время как при использовании традиционного подхода к оценке качества моделей прогнозирования возможно скачкообразное то уменьшение, то увеличение значений показателя и количества несовпадения тенденций «лучшего» антитела (см. рис. 7 и 8). При этом в обоих случаях наблюдается постепенное уменьшение значений средней относительной ошибки прогнозирования AFER «лучшего» антитела. Следует отметить, что величина показателя несовпадений тенденций Tendency (см. рис. 5, 7 и 9 (I-а, II-а, III-а, IV-а)) определяется не только количеством ошибочно спрогнозированных тенденций (см. рис. 6, 8 и 9 (I-б, II-б, III-б, IV-б)), но и по,k что отражено в формуле (2). При этом в ходе рядком модели прогнозирования смены поколений МАКО уменьшение величины показателя несовпадений тенденций Tendency  (2) может происходить не только за счет уменьшения количества ошибочно спрогнозированных тенденций, но и за счет уменьшения порядка модели .k  Данный факт хорошо продемонстрирован на рис. 9 (IV-а и прогнозирования IV-б) на интервале от 0 до 200 поколений. Как показывает анализ, при применении традиционного подхода к оценке качества моделей прогнозирования «приемлемой» моделью может быть признана та, которая обладает меньшим значением средней относительной ошибки прогнозирования AFER (1), но при этом «плохим» значением показателя несовпадения тенденций Tendency (2). Использование предлагаемого подхода к оценке качества моделей прогнозирования позволит сбалансировать значения средней относительной ошибки прогнозирования AFER (1) и показателя несовпадения тенденций Tendency (2). При этом удастся в ходе смены поколений МАКО исключать из дальнейшего рассмотрения антитела (и соответствующие им модели прогнозирования) с худшими значениями показателя несовпадения тенденций Tendency (2), поскольку в процессе смены поколений МАКО для антител будет запрещено увеличение значения показателя несовпадения тенденций Tendency (2). 

Заключение 

Предлагаемый подход к оценке качества моделей прогнозирования на основе СБД с применением МАКО обеспечивает совместный одновременный учет «лучших» значений средней относительной ошибки прогнозирования AFER (1) и показателя несовпадения тенденций (2), позволяя при реализации МАКО исключить из рассмотрения модели прогнозирования, характеризующиеся большими Tendency и сузить область поиска значениями показателя несовпадения тенденций искомого решения. Модели прогнозирования на основе СБД и МАКО позволяют существенно сократить время подбора аналитической зависимости, наилучшим образом (с точки зрения одновременной минимизации средней относительной ошибки прогнозирования AFER  и показателя несовпадения тенденций вестные значения коротких ВР, и могут быть рекомендованы для решения задач краткосрочного прогнозирования (на 1–3 шага вперед). Подход к оценке качества моделей прогнозирования, реализующий совместный одновременный учет «лучших» значений средней относительной ошибки прогнозирования AFER (1) и показателя несовпадения тенденций может быть использован при разработке моделей прогнозирования, предполагающих применение тех или иных эволюционных алгоритмов, например, при разработке нечетких моделей прогнозирования с использованием генетических алгоритмов [2–4, 12, 13]. 

